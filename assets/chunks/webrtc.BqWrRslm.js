import{d as Fi,h as Dt,z as Pi,a5 as go,G as We,Y as yo,x as Mn,N as wo,a6 as Bi,k as mo,y as ji,o as _o,b as bo,w as vo,l as Eo,r as So,m as Co}from"./framework.CSgk8b6D.js";const gt=()=>new Map,hr=e=>{const t=gt();return e.forEach((n,r)=>{t.set(r,n)}),t},mt=(e,t,n)=>{let r=e.get(t);return r===void 0&&e.set(t,r=n()),r},ko=(e,t)=>{const n=[];for(const[r,s]of e)n.push(t(s,r));return n},Ro=(e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1},re=()=>new Set,$n=e=>e[e.length-1],Ao=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},Ht=Array.from,To=Array.isArray;class Vi{constructor(){this._observers=gt()}on(t,n){return mt(this._observers,t,re).add(n),n}once(t,n){const r=(...s)=>{this.off(t,r),n(...s)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return Ht((this._observers.get(t)||gt()).values()).forEach(r=>r(...n))}destroy(){this._observers=gt()}}class Wi{constructor(){this._observers=gt()}on(t,n){mt(this._observers,t,re).add(n)}once(t,n){const r=(...s)=>{this.off(t,r),n(...s)};this.on(t,r)}off(t,n){const r=this._observers.get(t);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(t))}emit(t,n){return Ht((this._observers.get(t)||gt()).values()).forEach(r=>r(...n))}destroy(){this._observers=gt()}}const Ut=Math.floor,ln=Math.abs,Do=Math.log10,Tr=(e,t)=>e<t?e:t,me=(e,t)=>e>t?e:t,qi=e=>e!==0?e<0:1/e<0,ri=1,ii=2,Kn=4,Xn=8,qe=32,qt=64,wt=128,Un=31,ur=63,le=127,Io=2147483647,zi=Number.MAX_SAFE_INTEGER,Oo=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&Ut(e)===e),Lo=String.fromCharCode,No=e=>e.toLowerCase(),xo=/^\s*/g,Mo=e=>e.replace(xo,""),Uo=/([A-Z])/g,si=(e,t)=>Mo(e.replace(Uo,n=>`${t}${No(n)}`)),Fo=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.codePointAt(s);return r},ze=typeof TextEncoder<"u"?new TextEncoder:null,Po=e=>ze.encode(e),fr=ze?Po:Fo;let je=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});je&&je.decode(new Uint8Array).length===1&&(je=null);class Qe{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const ht=()=>new Qe,Bo=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},nt=e=>{const t=new Uint8Array(Bo(e));let n=0;for(let r=0;r<e.bufs.length;r++){const s=e.bufs[r];t.set(s,n),n+=s.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},jo=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(me(n,t)*2),e.cpos=0)},at=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},He=at,W=(e,t)=>{for(;t>le;)at(e,wt|le&t),t=Ut(t/128);at(e,le&t)},Dr=(e,t)=>{const n=qi(t);for(n&&(t=-t),at(e,(t>ur?wt:0)|(n?qt:0)|ur&t),t=Ut(t/64);t>0;)at(e,(t>le?wt:0)|le&t),t=Ut(t/128)},dr=new Uint8Array(3e4),Vo=dr.length/3,Wo=(e,t)=>{if(t.length<Vo){const n=ze.encodeInto(t,dr).written||0;W(e,n);for(let r=0;r<n;r++)at(e,dr[r])}else it(e,fr(t))},qo=(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;W(e,r);for(let s=0;s<r;s++)at(e,n.codePointAt(s))},xt=ze&&ze.encodeInto?Wo:qo,Fn=(e,t)=>{const n=e.cbuf.length,r=e.cpos,s=Tr(n-r,t.length),o=t.length-s;e.cbuf.set(t.subarray(0,s),r),e.cpos+=s,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(me(n*2,o)),e.cbuf.set(t.subarray(s)),e.cpos=o)},it=(e,t)=>{W(e,t.byteLength),Fn(e,t)},Ir=(e,t)=>{jo(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},zo=(e,t)=>Ir(e,4).setFloat32(0,t,!1),Ho=(e,t)=>Ir(e,8).setFloat64(0,t,!1),Yo=(e,t)=>Ir(e,8).setBigInt64(0,t,!1),oi=new DataView(new ArrayBuffer(4)),Jo=e=>(oi.setFloat32(0,e),oi.getFloat32(0)===e),Te=(e,t)=>{switch(typeof t){case"string":at(e,119),xt(e,t);break;case"number":Oo(t)&&ln(t)<=Io?(at(e,125),Dr(e,t)):Jo(t)?(at(e,124),zo(e,t)):(at(e,123),Ho(e,t));break;case"bigint":at(e,122),Yo(e,t);break;case"object":if(t===null)at(e,126);else if(To(t)){at(e,117),W(e,t.length);for(let n=0;n<t.length;n++)Te(e,t[n])}else if(t instanceof Uint8Array)at(e,116),it(e,t);else{at(e,118);const n=Object.keys(t);W(e,n.length);for(let r=0;r<n.length;r++){const s=n[r];xt(e,s),Te(e,t[s])}}break;case"boolean":at(e,t?120:121);break;default:at(e,127)}};class ci extends Qe{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&W(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const ai=e=>{e.count>0&&(Dr(e.encoder,e.count===1?e.s:-e.s),e.count>1&&W(e.encoder,e.count-2))};class hn{constructor(){this.encoder=new Qe,this.s=0,this.count=0}write(t){this.s===t?this.count++:(ai(this),this.count=1,this.s=t)}toUint8Array(){return ai(this),nt(this.encoder)}}const li=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);Dr(e.encoder,t),e.count>1&&W(e.encoder,e.count-2)}};class Zn{constructor(){this.encoder=new Qe,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(li(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return li(this),nt(this.encoder)}}class Go{constructor(){this.sarr=[],this.s="",this.lensE=new hn}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new Qe;return this.sarr.push(this.s),this.s="",xt(t,this.sarr.join("")),Fn(t,this.lensE.toUint8Array()),nt(t)}}const Ft=e=>new Error(e),Mt=()=>{throw Ft("Method unimplemented")},Pt=()=>{throw Ft("Unexpected case")},Hi=Ft("Unexpected end of array"),Yi=Ft("Integer out of Range");class Pn{constructor(t){this.arr=t,this.pos=0}}const Vt=e=>new Pn(e),$o=e=>e.pos!==e.arr.length,Ko=(e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},lt=e=>Ko(e,H(e)),ue=e=>e.arr[e.pos++],H=e=>{let t=0,n=1;const r=e.arr.length;for(;e.pos<r;){const s=e.arr[e.pos++];if(t=t+(s&le)*n,n*=128,s<wt)return t;if(t>zi)throw Yi}throw Hi},Or=e=>{let t=e.arr[e.pos++],n=t&ur,r=64;const s=(t&qt)>0?-1:1;if(!(t&wt))return s*n;const o=e.arr.length;for(;e.pos<o;){if(t=e.arr[e.pos++],n=n+(t&le)*r,r*=128,t<wt)return s*n;if(n>zi)throw Yi}throw Hi},Xo=e=>{let t=H(e);if(t===0)return"";{let n=String.fromCodePoint(ue(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(ue(e));else for(;t>0;){const r=t<1e4?t:1e4,s=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,s),t-=r}return decodeURIComponent(escape(n))}},Zo=e=>je.decode(lt(e)),zt=je?Zo:Xo,Lr=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},Qo=e=>Lr(e,4).getFloat32(0,!1),tc=e=>Lr(e,8).getFloat64(0,!1),ec=e=>Lr(e,8).getBigInt64(0,!1),nc=[e=>{},e=>null,Or,Qo,tc,ec,e=>!1,e=>!0,zt,e=>{const t=H(e),n={};for(let r=0;r<t;r++){const s=zt(e);n[s]=De(e)}return n},e=>{const t=H(e),n=[];for(let r=0;r<t;r++)n.push(De(e));return n},lt],De=e=>nc[127-ue(e)](e);class hi extends Pn{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),$o(this)?this.count=H(this)+1:this.count=-1),this.count--,this.s}}class un extends Pn{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=Or(this);const t=qi(this.s);this.count=1,t&&(this.s=-this.s,this.count=H(this)+2)}return this.count--,this.s}}class Qn extends Pn{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=Or(this),n=t&1;this.diff=Ut(t/2),this.count=1,n&&(this.count=H(this)+2)}return this.s+=this.diff,this.count--,this.s}}class rc{constructor(t){this.decoder=new un(t),this.str=zt(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}}const ic=crypto.getRandomValues.bind(crypto),sc=Math.random,Ji=()=>ic(new Uint32Array(1))[0],oc="10000000-1000-4000-8000"+-1e11,Gi=()=>oc.replace(/[018]/g,e=>(e^Ji()&15>>e/4).toString(16)),Yt=Date.now,ui=e=>new Promise(e);Promise.all.bind(Promise);const cc=e=>Promise.reject(e),Nr=e=>Promise.resolve(e),fi=e=>e===void 0?null:e;class ac{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}}let $i=new ac,xr=!0;try{typeof localStorage<"u"&&localStorage&&($i=localStorage,xr=!1)}catch{}const Ki=$i,lc=e=>xr||addEventListener("storage",e),hc=e=>xr||removeEventListener("storage",e),uc=Object.assign,fc=Object.keys,dc=(e,t)=>{for(const n in e)t(e[n],n)},dn=e=>fc(e).length,pc=e=>{for(const t in e)return!1;return!0},gc=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},Xi=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),yc=(e,t)=>e===t||dn(e)===dn(t)&&gc(e,(n,r)=>(n!==void 0||Xi(t,r))&&t[r]===n),Mr=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&Mr(e,t,n+1)}},wc=()=>{},mc=e=>e,_c=(e,t)=>e===t,Ve=(e,t)=>{if(e==null||t==null)return _c(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break}case Set:{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break}case Map:{if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!Ve(e.get(n),t.get(n)))return!1;break}case Object:if(dn(e)!==dn(t))return!1;for(const n in e)if(!Xi(e,n)||!Ve(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Ve(e[n],t[n]))return!1;break;default:return!1}return!0},bc=(e,t)=>t.includes(e);var Zi={};const Ie=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",Qi=typeof window<"u"&&typeof document<"u"&&!Ie;let Lt;const vc=()=>{if(Lt===void 0)if(Ie){Lt=gt();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];r[0]==="-"?(t!==null&&Lt.set(t,""),t=r):t!==null&&(Lt.set(t,r),t=null)}t!==null&&Lt.set(t,"")}else typeof location=="object"?(Lt=gt(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,n]=e.split("=");Lt.set(`--${si(t,"-")}`,n),Lt.set(`-${si(t,"-")}`,n)}})):Lt=gt();return Lt},pr=e=>vc().has(e),pn=e=>fi(Ie?Zi[e.toUpperCase().replaceAll("-","_")]:Ki.getItem(e)),Ec=e=>pr("--"+e)||pn(e)!==null;Ec("production");const di=Ie&&bc(Zi.FORCE_COLOR,["true","1","2"]),Sc=!pr("no-colors")&&(!Ie||process.stdout.isTTY||di)&&(!Ie||pr("color")||di||pn("COLORTERM")!==null||(pn("TERM")||"").includes("color")),ts=e=>new Uint8Array(e),Cc=(e,t,n)=>new Uint8Array(e,t,n),kc=e=>new Uint8Array(e),Rc=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Lo(e[n]);return btoa(t)},Ac=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),Tc=e=>{const t=atob(e),n=ts(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},Dc=e=>{const t=Buffer.from(e,"base64");return Cc(t.buffer,t.byteOffset,t.byteLength)},es=Qi?Rc:Ac,ns=Qi?Tc:Dc,Ic=e=>{const t=ts(e.byteLength);return t.set(e),t};class Oc{constructor(t,n){this.left=t,this.right=n}}const Wt=(e,t)=>new Oc(e,t);typeof DOMParser<"u"&&new DOMParser;const Lc=e=>ko(e,(t,n)=>`${n}:${t};`).join(""),Nc=JSON.stringify,Gt=Symbol,St=Gt(),fe=Gt(),rs=Gt(),Ur=Gt(),is=Gt(),ss=Gt(),os=Gt(),Fr=Gt(),Bn=Gt(),xc=e=>{var r;e.length===1&&((r=e[0])==null?void 0:r.constructor)===Function&&(e=e[0]());const t=[];let n=0;for(;n<e.length;n++){const s=e[n];s===void 0||s.constructor===String||s.constructor===Number||s.constructor===Object&&t.push(JSON.stringify(s))}return t},pi=[is,os,Fr,rs];let tr=0,gi=Yt();const Mc=(e,t)=>{const n=pi[tr],r=pn("log"),s=r!==null&&(r==="*"||r==="true"||new RegExp(r,"gi").test(t));return tr=(tr+1)%pi.length,t+=": ",s?(...o)=>{var h;o.length===1&&((h=o[0])==null?void 0:h.constructor)===Function&&(o=o[0]());const a=Yt(),l=a-gi;gi=a,e(n,t,Bn,...o.map(p=>{switch(p!=null&&p.constructor===Uint8Array&&(p=Array.from(p)),typeof p){case"string":case"symbol":return p;default:return Nc(p)}}),n," +"+l+"ms")}:wc},Uc={[St]:Wt("font-weight","bold"),[fe]:Wt("font-weight","normal"),[rs]:Wt("color","blue"),[is]:Wt("color","green"),[Ur]:Wt("color","grey"),[ss]:Wt("color","red"),[os]:Wt("color","purple"),[Fr]:Wt("color","orange"),[Bn]:Wt("color","black")},Fc=e=>{var a;e.length===1&&((a=e[0])==null?void 0:a.constructor)===Function&&(e=e[0]());const t=[],n=[],r=gt();let s=[],o=0;for(;o<e.length;o++){const l=e[o],h=Uc[l];if(h!==void 0)r.set(h.left,h.right);else{if(l===void 0)break;if(l.constructor===String||l.constructor===Number){const p=Lc(r);o>0||p.length>0?(t.push("%c"+l),n.push(p)):t.push(l)}else break}}for(o>0&&(s=n,s.unshift(t.join("")));o<e.length;o++){const l=e[o];l instanceof Symbol||s.push(l)}return s},Pc=Sc?Fc:xc,cs=(...e)=>{console.log(...Pc(e)),Bc.forEach(t=>t.print(e))},Bc=re(),jc=e=>Mc(cs,e),as=e=>({[Symbol.iterator](){return this},next:e}),Vc=(e,t)=>as(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),er=(e,t)=>as(()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}});class Pr{constructor(t,n){this.clock=t,this.len=n}}class tn{constructor(){this.clients=new Map}}const ls=(e,t,n)=>t.clients.forEach((r,s)=>{const o=e.doc.store.clients.get(s);for(let a=0;a<r.length;a++){const l=r[a];Es(e,o,l.clock,l.len,n)}}),Wc=(e,t)=>{let n=0,r=e.length-1;for(;n<=r;){const s=Ut((n+r)/2),o=e[s],a=o.clock;if(a<=t){if(t<a+o.len)return s;n=s+1}else r=s-1}return null},hs=(e,t)=>{const n=e.clients.get(t.client);return n!==void 0&&Wc(n,t.clock)!==null},Br=e=>{e.clients.forEach(t=>{t.sort((s,o)=>s.clock-o.clock);let n,r;for(n=1,r=1;n<t.length;n++){const s=t[r-1],o=t[n];s.clock+s.len>=o.clock?s.len=me(s.len,o.clock+o.len-s.clock):(r<n&&(t[r]=o),r++)}t.length=r})},qc=e=>{const t=new tn;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,s)=>{if(!t.clients.has(s)){const o=r.slice();for(let a=n+1;a<e.length;a++)Ao(o,e[a].clients.get(s)||[]);t.clients.set(s,o)}});return Br(t),t},gn=(e,t,n,r)=>{mt(e.clients,t,()=>[]).push(new Pr(n,r))},zc=()=>new tn,Hc=e=>{const t=zc();return e.clients.forEach((n,r)=>{const s=[];for(let o=0;o<n.length;o++){const a=n[o];if(a.deleted){const l=a.id.clock;let h=a.length;if(o+1<n.length)for(let p=n[o+1];o+1<n.length&&p.deleted;p=n[++o+1])h+=p.length;s.push(new Pr(l,h))}}s.length>0&&t.clients.set(r,s)}),t},Me=(e,t)=>{W(e.restEncoder,t.clients.size),Ht(t.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{e.resetDsCurVal(),W(e.restEncoder,n);const s=r.length;W(e.restEncoder,s);for(let o=0;o<s;o++){const a=r[o];e.writeDsClock(a.clock),e.writeDsLen(a.len)}})},jr=e=>{const t=new tn,n=H(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const s=H(e.restDecoder),o=H(e.restDecoder);if(o>0){const a=mt(t.clients,s,()=>[]);for(let l=0;l<o;l++)a.push(new Pr(e.readDsClock(),e.readDsLen()))}}return t},yi=(e,t,n)=>{const r=new tn,s=H(e.restDecoder);for(let o=0;o<s;o++){e.resetDsCurVal();const a=H(e.restDecoder),l=H(e.restDecoder),h=n.clients.get(a)||[],p=ut(n,a);for(let m=0;m<l;m++){const u=e.readDsClock(),d=u+e.readDsLen();if(u<p){p<d&&gn(r,a,p,d-p);let w=Bt(h,u),g=h[w];for(!g.deleted&&g.id.clock<u&&(h.splice(w+1,0,En(t,g,u-g.id.clock)),w++);w<h.length&&(g=h[w++],g.id.clock<d);)g.deleted||(d<g.id.clock+g.length&&h.splice(w,0,En(t,g,d-g.id.clock)),g.delete(t))}else gn(r,a,u,d-u)}}if(r.clients.size>0){const o=new de;return W(o.restEncoder,0),Me(o,r),o.toUint8Array()}return null},us=Ji;class _e extends Vi{constructor({guid:t=Gi(),collectionid:n=null,gc:r=!0,gcFilter:s=()=>!0,meta:o=null,autoLoad:a=!1,shouldLoad:l=!0}={}){super(),this.gc=r,this.gcFilter=s,this.clientID=us(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new bs,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=l,this.autoLoad=a,this.meta=o,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=ui(p=>{this.on("load",()=>{this.isLoaded=!0,p(this)})});const h=()=>ui(p=>{const m=u=>{(u===void 0||u===!0)&&(this.off("sync",m),p())};this.on("sync",m)});this.on("sync",p=>{p===!1&&this.isSynced&&(this.whenSynced=h()),this.isSynced=p===void 0||p===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=h()}load(){const t=this._item;t!==null&&!this.shouldLoad&&tt(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Ht(this.subdocs).map(t=>t.guid))}transact(t,n=null){return tt(this,t,n)}get(t,n=dt){const r=mt(this.share,t,()=>{const o=new n;return o._integrate(this,null),o}),s=r.constructor;if(n!==dt&&s!==n)if(s===dt){const o=new n;o._map=r._map,r._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=o}),o._start=r._start;for(let a=o._start;a!==null;a=a.right)a.parent=o;return o._length=r._length,this.share.set(t,o),o._integrate(this,null),o}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return r}getArray(t=""){return this.get(t,It)}getText(t=""){return this.get(t,Jt)}getMap(t=""){return this.get(t,Ot)}getXmlElement(t=""){return this.get(t,Le)}getXmlFragment(t=""){return this.get(t,pe)}toJSON(){const t={};return this.share.forEach((n,r)=>{t[r]=n.toJSON()}),t}destroy(){Ht(this.subdocs).forEach(n=>n.destroy());const t=this._item;if(t!==null){this._item=null;const n=t.content;n.doc=new _e({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,tt(t.parent.doc,r=>{const s=n.doc;t.deleted||r.subdocsAdded.add(s),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class fs{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return H(this.restDecoder)}readDsLen(){return H(this.restDecoder)}}class ds extends fs{readLeftID(){return X(H(this.restDecoder),H(this.restDecoder))}readRightID(){return X(H(this.restDecoder),H(this.restDecoder))}readClient(){return H(this.restDecoder)}readInfo(){return ue(this.restDecoder)}readString(){return zt(this.restDecoder)}readParentInfo(){return H(this.restDecoder)===1}readTypeRef(){return H(this.restDecoder)}readLen(){return H(this.restDecoder)}readAny(){return De(this.restDecoder)}readBuf(){return Ic(lt(this.restDecoder))}readJSON(){return JSON.parse(zt(this.restDecoder))}readKey(){return zt(this.restDecoder)}}class Yc{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=H(this.restDecoder),this.dsCurrVal}readDsLen(){const t=H(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class Oe extends Yc{constructor(t){super(t),this.keys=[],H(t),this.keyClockDecoder=new Qn(lt(t)),this.clientDecoder=new un(lt(t)),this.leftClockDecoder=new Qn(lt(t)),this.rightClockDecoder=new Qn(lt(t)),this.infoDecoder=new hi(lt(t),ue),this.stringDecoder=new rc(lt(t)),this.parentInfoDecoder=new hi(lt(t),ue),this.typeRefDecoder=new un(lt(t)),this.lenDecoder=new un(lt(t))}readLeftID(){return new Re(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Re(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return De(this.restDecoder)}readBuf(){return lt(this.restDecoder)}readJSON(){return De(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class ps{constructor(){this.restEncoder=ht()}toUint8Array(){return nt(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){W(this.restEncoder,t)}writeDsLen(t){W(this.restEncoder,t)}}class en extends ps{writeLeftID(t){W(this.restEncoder,t.client),W(this.restEncoder,t.clock)}writeRightID(t){W(this.restEncoder,t.client),W(this.restEncoder,t.clock)}writeClient(t){W(this.restEncoder,t)}writeInfo(t){He(this.restEncoder,t)}writeString(t){xt(this.restEncoder,t)}writeParentInfo(t){W(this.restEncoder,t?1:0)}writeTypeRef(t){W(this.restEncoder,t)}writeLen(t){W(this.restEncoder,t)}writeAny(t){Te(this.restEncoder,t)}writeBuf(t){it(this.restEncoder,t)}writeJSON(t){xt(this.restEncoder,JSON.stringify(t))}writeKey(t){xt(this.restEncoder,t)}}class gs{constructor(){this.restEncoder=ht(),this.dsCurrVal=0}toUint8Array(){return nt(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const n=t-this.dsCurrVal;this.dsCurrVal=t,W(this.restEncoder,n)}writeDsLen(t){t===0&&Pt(),W(this.restEncoder,t-1),this.dsCurrVal+=t}}class de extends gs{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Zn,this.clientEncoder=new hn,this.leftClockEncoder=new Zn,this.rightClockEncoder=new Zn,this.infoEncoder=new ci(He),this.stringEncoder=new Go,this.parentInfoEncoder=new ci(He),this.typeRefEncoder=new hn,this.lenEncoder=new hn}toUint8Array(){const t=ht();return W(t,0),it(t,this.keyClockEncoder.toUint8Array()),it(t,this.clientEncoder.toUint8Array()),it(t,this.leftClockEncoder.toUint8Array()),it(t,this.rightClockEncoder.toUint8Array()),it(t,nt(this.infoEncoder)),it(t,this.stringEncoder.toUint8Array()),it(t,nt(this.parentInfoEncoder)),it(t,this.typeRefEncoder.toUint8Array()),it(t,this.lenEncoder.toUint8Array()),Fn(t,nt(this.restEncoder)),nt(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){Te(this.restEncoder,t)}writeBuf(t){it(this.restEncoder,t)}writeJSON(t){Te(this.restEncoder,t)}writeKey(t){const n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}}const Jc=(e,t,n,r)=>{r=me(r,t[0].id.clock);const s=Bt(t,r);W(e.restEncoder,t.length-s),e.writeClient(n),W(e.restEncoder,r);const o=t[s];o.write(e,r-o.id.clock);for(let a=s+1;a<t.length;a++)t[a].write(e,0)},Vr=(e,t,n)=>{const r=new Map;n.forEach((s,o)=>{ut(t,o)>s&&r.set(o,s)}),jn(t).forEach((s,o)=>{n.has(o)||r.set(o,0)}),W(e.restEncoder,r.size),Ht(r.entries()).sort((s,o)=>o[0]-s[0]).forEach(([s,o])=>{Jc(e,t.clients.get(s),s,o)})},Gc=(e,t)=>{const n=gt(),r=H(e.restDecoder);for(let s=0;s<r;s++){const o=H(e.restDecoder),a=new Array(o),l=e.readClient();let h=H(e.restDecoder);n.set(l,{i:0,refs:a});for(let p=0;p<o;p++){const m=e.readInfo();switch(Un&m){case 0:{const u=e.readLen();a[p]=new vt(X(l,h),u),h+=u;break}case 10:{const u=H(e.restDecoder);a[p]=new Et(X(l,h),u),h+=u;break}default:{const u=(m&(qt|wt))===0,d=new ot(X(l,h),null,(m&wt)===wt?e.readLeftID():null,null,(m&qt)===qt?e.readRightID():null,u?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,u&&(m&qe)===qe?e.readString():null,Vs(e,m));a[p]=d,h+=d.length}}}}return n},$c=(e,t,n)=>{const r=[];let s=Ht(n.keys()).sort((w,g)=>w-g);if(s.length===0)return null;const o=()=>{if(s.length===0)return null;let w=n.get(s[s.length-1]);for(;w.refs.length===w.i;)if(s.pop(),s.length>0)w=n.get(s[s.length-1]);else return null;return w};let a=o();if(a===null)return null;const l=new bs,h=new Map,p=(w,g)=>{const E=h.get(w);(E==null||E>g)&&h.set(w,g)};let m=a.refs[a.i++];const u=new Map,d=()=>{for(const w of r){const g=w.id.client,E=n.get(g);E?(E.i--,l.clients.set(g,E.refs.slice(E.i)),n.delete(g),E.i=0,E.refs=[]):l.clients.set(g,[w]),s=s.filter(x=>x!==g)}r.length=0};for(;;){if(m.constructor!==Et){const g=mt(u,m.id.client,()=>ut(t,m.id.client))-m.id.clock;if(g<0)r.push(m),p(m.id.client,m.id.clock-1),d();else{const E=m.getMissing(e,t);if(E!==null){r.push(m);const x=n.get(E)||{refs:[],i:0};if(x.refs.length===x.i)p(E,ut(t,E)),d();else{m=x.refs[x.i++];continue}}else(g===0||g<m.length)&&(m.integrate(e,g),u.set(m.id.client,m.id.clock+m.length))}}if(r.length>0)m=r.pop();else if(a!==null&&a.i<a.refs.length)m=a.refs[a.i++];else{if(a=o(),a===null)break;m=a.refs[a.i++]}}if(l.clients.size>0){const w=new de;return Vr(w,l,new Map),W(w.restEncoder,0),{missing:h,update:w.toUint8Array()}}return null},Kc=(e,t)=>Vr(e,t.doc.store,t.beforeState),Xc=(e,t,n,r=new Oe(e))=>tt(t,s=>{s.local=!1;let o=!1;const a=s.doc,l=a.store,h=Gc(r,a),p=$c(s,l,h),m=l.pendingStructs;if(m){for(const[d,w]of m.missing)if(w<ut(l,d)){o=!0;break}if(p){for(const[d,w]of p.missing){const g=m.missing.get(d);(g==null||g>w)&&m.missing.set(d,w)}m.update=yn([m.update,p.update])}}else l.pendingStructs=p;const u=yi(r,s,l);if(l.pendingDs){const d=new Oe(Vt(l.pendingDs));H(d.restDecoder);const w=yi(d,s,l);u&&w?l.pendingDs=yn([u,w]):l.pendingDs=u||w}else l.pendingDs=u;if(o){const d=l.pendingStructs.update;l.pendingStructs=null,ys(s.doc,d)}},n,!1),ys=(e,t,n,r=Oe)=>{const s=Vt(t);Xc(s,e,n,new r(s))},Zc=(e,t,n)=>ys(e,t,n,ds),Qc=(e,t,n=new Map)=>{Vr(e,t.store,n),Me(e,Hc(t.store))},ta=(e,t=new Uint8Array([0]),n=new de)=>{const r=ws(t);Qc(n,e,r);const s=[n.toUint8Array()];if(e.store.pendingDs&&s.push(e.store.pendingDs),e.store.pendingStructs&&s.push(ya(e.store.pendingStructs.update,t)),s.length>1){if(n.constructor===en)return pa(s.map((o,a)=>a===0?o:ma(o)));if(n.constructor===de)return yn(s)}return s[0]},ea=(e,t)=>ta(e,t,new en),na=e=>{const t=new Map,n=H(e.restDecoder);for(let r=0;r<n;r++){const s=H(e.restDecoder),o=H(e.restDecoder);t.set(s,o)}return t},ws=e=>na(new fs(Vt(e))),ms=(e,t)=>(W(e.restEncoder,t.size),Ht(t.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{W(e.restEncoder,n),W(e.restEncoder,r)}),e),ra=(e,t)=>ms(e,jn(t.store)),ia=(e,t=new gs)=>(e instanceof Map?ms(t,e):ra(t,e),t.toUint8Array()),sa=e=>ia(e,new ps);class oa{constructor(){this.l=[]}}const wi=()=>new oa,mi=(e,t)=>e.l.push(t),_i=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter(s=>t!==s),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},_s=(e,t,n)=>Mr(e.l,[t,n]);class Re{constructor(t,n){this.client=t,this.clock=n}}const sn=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,X=(e,t)=>new Re(e,t),ca=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw Pt()},ke=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!hs(t.ds,e.id),gr=(e,t)=>{const n=mt(e.meta,gr,re),r=e.doc.store;n.has(t)||(t.sv.forEach((s,o)=>{s<ut(r,o)&&ie(e,X(o,s))}),ls(e,t.ds,s=>{}),n.add(t))};class bs{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const jn=e=>{const t=new Map;return e.clients.forEach((n,r)=>{const s=n[n.length-1];t.set(r,s.id.clock+s.length)}),t},ut=(e,t)=>{const n=e.clients.get(t);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},vs=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw Pt()}n.push(t)},Bt=(e,t)=>{let n=0,r=e.length-1,s=e[r],o=s.id.clock;if(o===t)return r;let a=Ut(t/(o+s.length-1)*r);for(;n<=r;){if(s=e[a],o=s.id.clock,o<=t){if(t<o+s.length)return a;n=a+1}else r=a-1;a=Ut((n+r)/2)}throw Pt()},aa=(e,t)=>{const n=e.clients.get(t.client);return n[Bt(n,t.clock)]},nr=aa,yr=(e,t,n)=>{const r=Bt(t,n),s=t[r];return s.id.clock<n&&s instanceof ot?(t.splice(r+1,0,En(e,s,n-s.id.clock)),r+1):r},ie=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[yr(e,n,t.clock)]},bi=(e,t,n)=>{const r=t.clients.get(n.client),s=Bt(r,n.clock),o=r[s];return n.clock!==o.id.clock+o.length-1&&o.constructor!==vt&&r.splice(s+1,0,En(e,o,n.clock-o.id.clock+1)),o},la=(e,t,n)=>{const r=e.clients.get(t.id.client);r[Bt(r,t.id.clock)]=n},Es=(e,t,n,r,s)=>{if(r===0)return;const o=n+r;let a=yr(e,t,n),l;do l=t[a++],o<l.id.clock+l.length&&yr(e,t,o),s(l);while(a<t.length&&t[a].id.clock<o)};class ha{constructor(t,n,r){this.doc=t,this.deleteSet=new tn,this.beforeState=jn(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const vi=(e,t)=>t.deleteSet.clients.size===0&&!Ro(t.afterState,(n,r)=>t.beforeState.get(r)!==n)?!1:(Br(t.deleteSet),Kc(e,t),Me(e,t.deleteSet),!0),Ei=(e,t,n)=>{const r=t._item;(r===null||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&mt(e.changed,t,re).add(n)},fn=(e,t)=>{let n=e[t],r=e[t-1],s=t;for(;s>0;n=r,r=e[--s-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof ot&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const o=t-s;return o&&e.splice(t+1-o,o),o},ua=(e,t,n)=>{for(const[r,s]of e.clients.entries()){const o=t.clients.get(r);for(let a=s.length-1;a>=0;a--){const l=s[a],h=l.clock+l.len;for(let p=Bt(o,l.clock),m=o[p];p<o.length&&m.id.clock<h;m=o[++p]){const u=o[p];if(l.clock+l.len<=u.id.clock)break;u instanceof ot&&u.deleted&&!u.keep&&n(u)&&u.gc(t,!1)}}}},fa=(e,t)=>{e.clients.forEach((n,r)=>{const s=t.clients.get(r);for(let o=n.length-1;o>=0;o--){const a=n[o],l=Tr(s.length-1,1+Bt(s,a.clock+a.len-1));for(let h=l,p=s[h];h>0&&p.id.clock>=a.clock;p=s[h])h-=1+fn(s,h)}})},Ss=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,s=r.store,o=n.deleteSet,a=n._mergeStructs;try{Br(o),n.afterState=jn(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const l=[];n.changed.forEach((h,p)=>l.push(()=>{(p._item===null||!p._item.deleted)&&p._callObserver(n,h)})),l.push(()=>{n.changedParentTypes.forEach((h,p)=>{p._dEH.l.length>0&&(p._item===null||!p._item.deleted)&&(h=h.filter(m=>m.target._item===null||!m.target._item.deleted),h.forEach(m=>{m.currentTarget=p,m._path=null}),h.sort((m,u)=>m.path.length-u.path.length),_s(p._dEH,h,n))})}),l.push(()=>r.emit("afterTransaction",[n,r])),Mr(l,[]),n._needFormattingCleanup&&La(n)}finally{r.gc&&ua(o,s,r.gcFilter),fa(o,s),n.afterState.forEach((m,u)=>{const d=n.beforeState.get(u)||0;if(d!==m){const w=s.clients.get(u),g=me(Bt(w,d),1);for(let E=w.length-1;E>=g;)E-=1+fn(w,E)}});for(let m=a.length-1;m>=0;m--){const{client:u,clock:d}=a[m].id,w=s.clients.get(u),g=Bt(w,d);g+1<w.length&&fn(w,g+1)>1||g>0&&fn(w,g)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(cs(Fr,St,"[yjs] ",fe,ss,"Changed the client-id because another client seems to be using it."),r.clientID=us()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const m=new en;vi(m,n)&&r.emit("update",[m.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const m=new de;vi(m,n)&&r.emit("updateV2",[m.toUint8Array(),n.origin,r,n])}const{subdocsAdded:l,subdocsLoaded:h,subdocsRemoved:p}=n;(l.size>0||p.size>0||h.size>0)&&(l.forEach(m=>{m.clientID=r.clientID,m.collectionid==null&&(m.collectionid=r.collectionid),r.subdocs.add(m)}),p.forEach(m=>r.subdocs.delete(m)),r.emit("subdocs",[{loaded:h,added:l,removed:p},r,n]),p.forEach(m=>m.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):Ss(e,t+1)}}},tt=(e,t,n=null,r=!0)=>{const s=e._transactionCleanups;let o=!1,a=null;e._transaction===null&&(o=!0,e._transaction=new ha(e,n,r),s.push(e._transaction),s.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{a=t(e._transaction)}finally{if(o){const l=e._transaction===s[0];e._transaction=null,l&&Ss(s,0)}}return a};function*da(e){const t=H(e.restDecoder);for(let n=0;n<t;n++){const r=H(e.restDecoder),s=e.readClient();let o=H(e.restDecoder);for(let a=0;a<r;a++){const l=e.readInfo();if(l===10){const h=H(e.restDecoder);yield new Et(X(s,o),h),o+=h}else if(Un&l){const h=(l&(qt|wt))===0,p=new ot(X(s,o),null,(l&wt)===wt?e.readLeftID():null,null,(l&qt)===qt?e.readRightID():null,h?e.readParentInfo()?e.readString():e.readLeftID():null,h&&(l&qe)===qe?e.readString():null,Vs(e,l));yield p,o+=p.length}else{const h=e.readLen();yield new vt(X(s,o),h),o+=h}}}}class Wr{constructor(t,n){this.gen=da(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Et);return this.curr}}class qr{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const pa=e=>yn(e,ds,en),ga=(e,t)=>{if(e.constructor===vt){const{client:n,clock:r}=e.id;return new vt(X(n,r+t),e.length-t)}else if(e.constructor===Et){const{client:n,clock:r}=e.id;return new Et(X(n,r+t),e.length-t)}else{const n=e,{client:r,clock:s}=n.id;return new ot(X(r,s+t),null,X(r,s+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},yn=(e,t=Oe,n=de)=>{if(e.length===1)return e[0];const r=e.map(m=>new t(Vt(m)));let s=r.map(m=>new Wr(m,!0)),o=null;const a=new n,l=new qr(a);for(;s=s.filter(d=>d.curr!==null),s.sort((d,w)=>{if(d.curr.id.client===w.curr.id.client){const g=d.curr.id.clock-w.curr.id.clock;return g===0?d.curr.constructor===w.curr.constructor?0:d.curr.constructor===Et?1:-1:g}else return w.curr.id.client-d.curr.id.client}),s.length!==0;){const m=s[0],u=m.curr.id.client;if(o!==null){let d=m.curr,w=!1;for(;d!==null&&d.id.clock+d.length<=o.struct.id.clock+o.struct.length&&d.id.client>=o.struct.id.client;)d=m.next(),w=!0;if(d===null||d.id.client!==u||w&&d.id.clock>o.struct.id.clock+o.struct.length)continue;if(u!==o.struct.id.client)ee(l,o.struct,o.offset),o={struct:d,offset:0},m.next();else if(o.struct.id.clock+o.struct.length<d.id.clock)if(o.struct.constructor===Et)o.struct.length=d.id.clock+d.length-o.struct.id.clock;else{ee(l,o.struct,o.offset);const g=d.id.clock-o.struct.id.clock-o.struct.length;o={struct:new Et(X(u,o.struct.id.clock+o.struct.length),g),offset:0}}else{const g=o.struct.id.clock+o.struct.length-d.id.clock;g>0&&(o.struct.constructor===Et?o.struct.length-=g:d=ga(d,g)),o.struct.mergeWith(d)||(ee(l,o.struct,o.offset),o={struct:d,offset:0},m.next())}}else o={struct:m.curr,offset:0},m.next();for(let d=m.curr;d!==null&&d.id.client===u&&d.id.clock===o.struct.id.clock+o.struct.length&&d.constructor!==Et;d=m.next())ee(l,o.struct,o.offset),o={struct:d,offset:0}}o!==null&&(ee(l,o.struct,o.offset),o=null),zr(l);const h=r.map(m=>jr(m)),p=qc(h);return Me(a,p),a.toUint8Array()},ya=(e,t,n=Oe,r=de)=>{const s=ws(t),o=new r,a=new qr(o),l=new n(Vt(e)),h=new Wr(l,!1);for(;h.curr;){const m=h.curr,u=m.id.client,d=s.get(u)||0;if(h.curr.constructor===Et){h.next();continue}if(m.id.clock+m.length>d)for(ee(a,m,me(d-m.id.clock,0)),h.next();h.curr&&h.curr.id.client===u;)ee(a,h.curr,0),h.next();else for(;h.curr&&h.curr.id.client===u&&h.curr.id.clock+h.curr.length<=d;)h.next()}zr(a);const p=jr(l);return Me(o,p),o.toUint8Array()},Cs=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:nt(e.encoder.restEncoder)}),e.encoder.restEncoder=ht(),e.written=0)},ee=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&Cs(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),W(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},zr=e=>{Cs(e);const t=e.encoder.restEncoder;W(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];W(t,r.written),Fn(t,r.restEncoder)}},wa=(e,t,n,r)=>{const s=new n(Vt(e)),o=new Wr(s,!1),a=new r,l=new qr(a);for(let p=o.curr;p!==null;p=o.next())ee(l,t(p),0);zr(l);const h=jr(s);return Me(a,h),a.toUint8Array()},ma=e=>wa(e,mc,Oe,en),Si="You must not compute changes after the event-handler fired.";class Vn{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=_a(this.currentTarget,this.target))}deletes(t){return hs(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ft(Si);const t=new Map,n=this.target;this.transaction.changed.get(n).forEach(s=>{if(s!==null){const o=n._map.get(s);let a,l;if(this.adds(o)){let h=o.left;for(;h!==null&&this.adds(h);)h=h.left;if(this.deletes(o))if(h!==null&&this.deletes(h))a="delete",l=$n(h.content.getContent());else return;else h!==null&&this.deletes(h)?(a="update",l=$n(h.content.getContent())):(a="add",l=void 0)}else if(this.deletes(o))a="delete",l=$n(o.content.getContent());else return;t.set(s,{action:a,oldValue:l})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ft(Si);const n=this.target,r=re(),s=re(),o=[];if(t={added:r,deleted:s,delta:o,keys:this.keys},this.transaction.changed.get(n).has(null)){let l=null;const h=()=>{l&&o.push(l)};for(let p=n._start;p!==null;p=p.right)p.deleted?this.deletes(p)&&!this.adds(p)&&((l===null||l.delete===void 0)&&(h(),l={delete:0}),l.delete+=p.length,s.add(p)):this.adds(p)?((l===null||l.insert===void 0)&&(h(),l={insert:[]}),l.insert=l.insert.concat(p.content.getContent()),r.add(p)):((l===null||l.retain===void 0)&&(h(),l={retain:0}),l.retain+=p.length);l!==null&&l.retain===void 0&&h()}this._changes=t}return t}}const _a=(e,t)=>{const n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let r=0,s=t._item.parent._start;for(;s!==t._item&&s!==null;)s.deleted||r++,s=s.right;n.unshift(r)}t=t._item.parent}return n},ks=80;let Hr=0;class ba{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=Hr++}}const va=e=>{e.timestamp=Hr++},Rs=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=Hr++},Ea=(e,t,n)=>{if(e.length>=ks){const r=e.reduce((s,o)=>s.timestamp<o.timestamp?s:o);return Rs(r,t,n),r}else{const r=new ba(t,n);return e.push(r),r}},Wn=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const n=e._searchMarker.length===0?null:e._searchMarker.reduce((o,a)=>ln(t-o.index)<ln(t-a.index)?o:a);let r=e._start,s=0;for(n!==null&&(r=n.p,s=n.index,va(n));r.right!==null&&s<t;){if(!r.deleted&&r.countable){if(t<s+r.length)break;s+=r.length}r=r.right}for(;r.left!==null&&s>t;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);return n!==null&&ln(n.index-s)<r.parent.length/ks?(Rs(n,r,s),n):Ea(e._searchMarker,r,s)},Ye=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const s=e[r];if(n>0){let o=s.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)o=o.left,o&&!o.deleted&&o.countable&&(s.index-=o.length);if(o===null||o.marker===!0){e.splice(r,1);continue}s.p=o,o.marker=!0}(t<s.index||n>0&&t===s.index)&&(s.index=me(t,s.index+n))}},qn=(e,t,n)=>{const r=e,s=t.changedParentTypes;for(;mt(s,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;_s(r._eH,n,t)};class dt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=wi(),this._dEH=wi(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw Mt()}clone(){throw Mt()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){mi(this._eH,t)}observeDeep(t){mi(this._dEH,t)}unobserve(t){_i(this._eH,t)}unobserveDeep(t){_i(this._dEH,t)}toJSON(){}}const As=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const s=[];let o=e._start;for(;o!==null&&r>0;){if(o.countable&&!o.deleted){const a=o.content.getContent();if(a.length<=t)t-=a.length;else{for(let l=t;l<a.length&&r>0;l++)s.push(a[l]),r--;t=0}}o=o.right}return s},Ts=e=>{const t=[];let n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let s=0;s<r.length;s++)t.push(r[s])}n=n.right}return t},Je=(e,t)=>{let n=0,r=e._start;for(;r!==null;){if(r.countable&&!r.deleted){const s=r.content.getContent();for(let o=0;o<s.length;o++)t(s[o],n++,e)}r=r.right}},Ds=(e,t)=>{const n=[];return Je(e,(r,s)=>{n.push(t(r,s,e))}),n},Sa=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const s=n[r++];return n.length<=r&&(n=null),{done:!1,value:s}}}},Is=(e,t)=>{const n=Wn(e,t);let r=e._start;for(n!==null&&(r=n.p,t-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},wn=(e,t,n,r)=>{let s=n;const o=e.doc,a=o.clientID,l=o.store,h=n===null?t._start:n.right;let p=[];const m=()=>{p.length>0&&(s=new ot(X(a,ut(l,a)),s,s&&s.lastId,h,h&&h.id,t,null,new ge(p)),s.integrate(e,0),p=[])};r.forEach(u=>{if(u===null)p.push(u);else switch(u.constructor){case Number:case Object:case Boolean:case Array:case String:p.push(u);break;default:switch(m(),u.constructor){case Uint8Array:case ArrayBuffer:s=new ot(X(a,ut(l,a)),s,s&&s.lastId,h,h&&h.id,t,null,new nn(new Uint8Array(u))),s.integrate(e,0);break;case _e:s=new ot(X(a,ut(l,a)),s,s&&s.lastId,h,h&&h.id,t,null,new rn(u)),s.integrate(e,0);break;default:if(u instanceof dt)s=new ot(X(a,ut(l,a)),s,s&&s.lastId,h,h&&h.id,t,null,new $t(u)),s.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),m()},Os=()=>Ft("Length exceeded!"),Ls=(e,t,n,r)=>{if(n>t._length)throw Os();if(n===0)return t._searchMarker&&Ye(t._searchMarker,n,r.length),wn(e,t,null,r);const s=n,o=Wn(t,n);let a=t._start;for(o!==null&&(a=o.p,n-=o.index,n===0&&(a=a.prev,n+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(n<=a.length){n<a.length&&ie(e,X(a.id.client,a.id.clock+n));break}n-=a.length}return t._searchMarker&&Ye(t._searchMarker,s,r.length),wn(e,t,a,r)},Ca=(e,t,n)=>{let s=(t._searchMarker||[]).reduce((o,a)=>a.index>o.index?a:o,{index:0,p:t._start}).p;if(s)for(;s.right;)s=s.right;return wn(e,t,s,n)},Ns=(e,t,n,r)=>{if(r===0)return;const s=n,o=r,a=Wn(t,n);let l=t._start;for(a!==null&&(l=a.p,n-=a.index);l!==null&&n>0;l=l.right)!l.deleted&&l.countable&&(n<l.length&&ie(e,X(l.id.client,l.id.clock+n)),n-=l.length);for(;r>0&&l!==null;)l.deleted||(r<l.length&&ie(e,X(l.id.client,l.id.clock+r)),l.delete(e),r-=l.length),l=l.right;if(r>0)throw Os();t._searchMarker&&Ye(t._searchMarker,s,-o+r)},mn=(e,t,n)=>{const r=t._map.get(n);r!==void 0&&r.delete(e)},Yr=(e,t,n,r)=>{const s=t._map.get(n)||null,o=e.doc,a=o.clientID;let l;if(r==null)l=new ge([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:l=new ge([r]);break;case Uint8Array:l=new nn(r);break;case _e:l=new rn(r);break;default:if(r instanceof dt)l=new $t(r);else throw new Error("Unexpected content type")}new ot(X(a,ut(o.store,a)),s,s&&s.lastId,null,null,t,n,l).integrate(e,0)},Jr=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},xs=e=>{const t={};return e._map.forEach((n,r)=>{n.deleted||(t[r]=n.content.getContent()[n.length-1])}),t},Ms=(e,t)=>{const n=e._map.get(t);return n!==void 0&&!n.deleted},ka=(e,t)=>{const n={};return e._map.forEach((r,s)=>{let o=r;for(;o!==null&&(!t.sv.has(o.id.client)||o.id.clock>=(t.sv.get(o.id.client)||0));)o=o.left;o!==null&&ke(o,t)&&(n[s]=o.content.getContent()[o.length-1])}),n},on=e=>Vc(e.entries(),t=>!t[1].deleted);class Ra extends Vn{constructor(t,n){super(t,n),this._transaction=n}}class It extends dt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const n=new It;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new It}clone(){const t=new It;return t.insert(0,this.toArray().map(n=>n instanceof dt?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,n){super._callObserver(t,n),qn(this,t,new Ra(this,t))}insert(t,n){this.doc!==null?tt(this.doc,r=>{Ls(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?tt(this.doc,n=>{Ca(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?tt(this.doc,r=>{Ns(r,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return Is(this,t)}toArray(){return Ts(this)}slice(t=0,n=this.length){return As(this,t,n)}toJSON(){return this.map(t=>t instanceof dt?t.toJSON():t)}map(t){return Ds(this,t)}forEach(t){Je(this,t)}[Symbol.iterator](){return Sa(this)}_write(t){t.writeTypeRef(Ka)}}const Aa=e=>new It;class Ta extends Vn{constructor(t,n,r){super(t,n),this.keysChanged=r}}class Ot extends dt{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((r,s)=>{this.set(s,r)}),this._prelimContent=null}_copy(){return new Ot}clone(){const t=new Ot;return this.forEach((n,r)=>{t.set(r,n instanceof dt?n.clone():n)}),t}_callObserver(t,n){qn(this,t,new Ta(this,t,n))}toJSON(){const t={};return this._map.forEach((n,r)=>{if(!n.deleted){const s=n.content.getContent()[n.length-1];t[r]=s instanceof dt?s.toJSON():s}}),t}get size(){return[...on(this._map)].length}keys(){return er(on(this._map),t=>t[0])}values(){return er(on(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return er(on(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((n,r)=>{n.deleted||t(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?tt(this.doc,n=>{mn(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?tt(this.doc,r=>{Yr(r,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return Jr(this,t)}has(t){return Ms(this,t)}clear(){this.doc!==null?tt(this.doc,t=>{this.forEach(function(n,r,s){mn(t,s,r)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(Xa)}}const Da=e=>new Ot,ne=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&yc(e,t);class wr{constructor(t,n,r,s){this.left=t,this.right=n,this.index=r,this.currentAttributes=s}forward(){switch(this.right===null&&Pt(),this.right.content.constructor){case ct:this.right.deleted||Ue(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Ci=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case ct:t.right.deleted||Ue(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&ie(e,X(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},cn=(e,t,n,r)=>{const s=new Map,o=r?Wn(t,n):null;if(o){const a=new wr(o.p.left,o.p,o.index,s);return Ci(e,a,n-o.index)}else{const a=new wr(null,t._start,0,s);return Ci(e,a,n)}},Us=(e,t,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===ct&&ne(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const s=e.doc,o=s.clientID;r.forEach((a,l)=>{const h=n.left,p=n.right,m=new ot(X(o,ut(s.store,o)),h,h&&h.lastId,p,p&&p.id,t,null,new ct(l,a));m.integrate(e,0),n.right=m,n.forward()})},Ue=(e,t)=>{const{key:n,value:r}=t;r===null?e.delete(n):e.set(n,r)},Fs=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===ct&&ne(t[e.right.content.key]??null,e.right.content.value)))break;e.forward()}},Ps=(e,t,n,r)=>{const s=e.doc,o=s.clientID,a=new Map;for(const l in r){const h=r[l],p=n.currentAttributes.get(l)??null;if(!ne(p,h)){a.set(l,p);const{left:m,right:u}=n;n.right=new ot(X(o,ut(s.store,o)),m,m&&m.lastId,u,u&&u.id,t,null,new ct(l,h)),n.right.integrate(e,0),n.forward()}}return a},rr=(e,t,n,r,s)=>{n.currentAttributes.forEach((d,w)=>{s[w]===void 0&&(s[w]=null)});const o=e.doc,a=o.clientID;Fs(n,s);const l=Ps(e,t,n,s),h=r.constructor===String?new jt(r):r instanceof dt?new $t(r):new be(r);let{left:p,right:m,index:u}=n;t._searchMarker&&Ye(t._searchMarker,n.index,h.getLength()),m=new ot(X(a,ut(o.store,a)),p,p&&p.lastId,m,m&&m.id,t,null,h),m.integrate(e,0),n.right=m,n.index=u,n.forward(),Us(e,t,n,l)},ki=(e,t,n,r,s)=>{const o=e.doc,a=o.clientID;Fs(n,s);const l=Ps(e,t,n,s);t:for(;n.right!==null&&(r>0||l.size>0&&(n.right.deleted||n.right.content.constructor===ct));){if(!n.right.deleted)switch(n.right.content.constructor){case ct:{const{key:h,value:p}=n.right.content,m=s[h];if(m!==void 0){if(ne(m,p))l.delete(h);else{if(r===0)break t;l.set(h,p)}n.right.delete(e)}else n.currentAttributes.set(h,p);break}default:r<n.right.length&&ie(e,X(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let h="";for(;r>0;r--)h+=`
`;n.right=new ot(X(a,ut(o.store,a)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new jt(h)),n.right.integrate(e,0),n.forward()}Us(e,t,n,l)},Bs=(e,t,n,r,s)=>{let o=t;const a=gt();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===ct){const p=o.content;a.set(p.key,p)}o=o.right}let l=0,h=!1;for(;t!==o;){if(n===t&&(h=!0),!t.deleted){const p=t.content;switch(p.constructor){case ct:{const{key:m,value:u}=p,d=r.get(m)??null;(a.get(m)!==p||d===u)&&(t.delete(e),l++,!h&&(s.get(m)??null)===u&&d!==u&&(d===null?s.delete(m):s.set(m,d))),!h&&!t.deleted&&Ue(s,p);break}}}t=t.right}return l},Ia=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===ct){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},Oa=e=>{let t=0;return tt(e.doc,n=>{let r=e._start,s=e._start,o=gt();const a=hr(o);for(;s;){if(s.deleted===!1)switch(s.content.constructor){case ct:Ue(a,s.content);break;default:t+=Bs(n,r,s,o,a),o=hr(a),r=s;break}s=s.right}}),t},La=e=>{const t=new Set,n=e.doc;for(const[r,s]of e.afterState.entries()){const o=e.beforeState.get(r)||0;s!==o&&Es(e,n.store.clients.get(r),o,s,a=>{!a.deleted&&a.content.constructor===ct&&a.constructor!==vt&&t.add(a.parent)})}tt(n,r=>{ls(e,e.deleteSet,s=>{if(s instanceof vt||!s.parent._hasFormatting||t.has(s.parent))return;const o=s.parent;s.content.constructor===ct?t.add(o):Ia(r,s)});for(const s of t)Oa(s)})},Ri=(e,t,n)=>{const r=n,s=hr(t.currentAttributes),o=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case $t:case be:case jt:n<t.right.length&&ie(e,X(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}o&&Bs(e,o,t.right,s,t.currentAttributes);const a=(t.left||t.right).parent;return a._searchMarker&&Ye(a._searchMarker,t.index,-r+n),t};class Na extends Vn{constructor(t,n,r){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(s=>{s===null?this.childListChanged=!0:this.keysChanged.add(s)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,n=[];tt(t,r=>{const s=new Map,o=new Map;let a=this.target._start,l=null;const h={};let p="",m=0,u=0;const d=()=>{if(l!==null){let w=null;switch(l){case"delete":u>0&&(w={delete:u}),u=0;break;case"insert":(typeof p=="object"||p.length>0)&&(w={insert:p},s.size>0&&(w.attributes={},s.forEach((g,E)=>{g!==null&&(w.attributes[E]=g)}))),p="";break;case"retain":m>0&&(w={retain:m},pc(h)||(w.attributes=uc({},h))),m=0;break}w&&n.push(w),l=null}};for(;a!==null;){switch(a.content.constructor){case $t:case be:this.adds(a)?this.deletes(a)||(d(),l="insert",p=a.content.getContent()[0],d()):this.deletes(a)?(l!=="delete"&&(d(),l="delete"),u+=1):a.deleted||(l!=="retain"&&(d(),l="retain"),m+=1);break;case jt:this.adds(a)?this.deletes(a)||(l!=="insert"&&(d(),l="insert"),p+=a.content.str):this.deletes(a)?(l!=="delete"&&(d(),l="delete"),u+=a.length):a.deleted||(l!=="retain"&&(d(),l="retain"),m+=a.length);break;case ct:{const{key:w,value:g}=a.content;if(this.adds(a)){if(!this.deletes(a)){const E=s.get(w)??null;ne(E,g)?g!==null&&a.delete(r):(l==="retain"&&d(),ne(g,o.get(w)??null)?delete h[w]:h[w]=g)}}else if(this.deletes(a)){o.set(w,g);const E=s.get(w)??null;ne(E,g)||(l==="retain"&&d(),h[w]=E)}else if(!a.deleted){o.set(w,g);const E=h[w];E!==void 0&&(ne(E,g)?E!==null&&a.delete(r):(l==="retain"&&d(),g===null?delete h[w]:h[w]=g))}a.deleted||(l==="insert"&&d(),Ue(s,a.content));break}}a=a.right}for(d();n.length>0;){const w=n[n.length-1];if(w.retain!==void 0&&w.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class Jt extends dt{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Jt}clone(){const t=new Jt;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);const r=new Na(this,t,n);qn(this,t,r),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===jt&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?tt(this.doc,r=>{const s=new wr(null,this._start,0,new Map);for(let o=0;o<t.length;o++){const a=t[o];if(a.insert!==void 0){const l=!n&&typeof a.insert=="string"&&o===t.length-1&&s.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof l!="string"||l.length>0)&&rr(r,this,s,l,a.attributes||{})}else a.retain!==void 0?ki(r,this,s,a.retain,a.attributes||{}):a.delete!==void 0&&Ri(r,s,a.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,r){const s=[],o=new Map,a=this.doc;let l="",h=this._start;function p(){if(l.length>0){const u={};let d=!1;o.forEach((g,E)=>{d=!0,u[E]=g});const w={insert:l};d&&(w.attributes=u),s.push(w),l=""}}const m=()=>{for(;h!==null;){if(ke(h,t)||n!==void 0&&ke(h,n))switch(h.content.constructor){case jt:{const u=o.get("ychange");t!==void 0&&!ke(h,t)?(u===void 0||u.user!==h.id.client||u.type!=="removed")&&(p(),o.set("ychange",r?r("removed",h.id):{type:"removed"})):n!==void 0&&!ke(h,n)?(u===void 0||u.user!==h.id.client||u.type!=="added")&&(p(),o.set("ychange",r?r("added",h.id):{type:"added"})):u!==void 0&&(p(),o.delete("ychange")),l+=h.content.str;break}case $t:case be:{p();const u={insert:h.content.getContent()[0]};if(o.size>0){const d={};u.attributes=d,o.forEach((w,g)=>{d[g]=w})}s.push(u);break}case ct:ke(h,t)&&(p(),Ue(o,h.content));break}h=h.right}p()};return t||n?tt(a,u=>{t&&gr(u,t),n&&gr(u,n),m()},"cleanup"):m(),s}insert(t,n,r){if(n.length<=0)return;const s=this.doc;s!==null?tt(s,o=>{const a=cn(o,this,t,!r);r||(r={},a.currentAttributes.forEach((l,h)=>{r[h]=l})),rr(o,this,a,n,r)}):this._pending.push(()=>this.insert(t,n,r))}insertEmbed(t,n,r){const s=this.doc;s!==null?tt(s,o=>{const a=cn(o,this,t,!r);rr(o,this,a,n,r||{})}):this._pending.push(()=>this.insertEmbed(t,n,r||{}))}delete(t,n){if(n===0)return;const r=this.doc;r!==null?tt(r,s=>{Ri(s,cn(s,this,t,!0),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,r){if(n===0)return;const s=this.doc;s!==null?tt(s,o=>{const a=cn(o,this,t,!1);a.right!==null&&ki(o,this,a,n,r)}):this._pending.push(()=>this.format(t,n,r))}removeAttribute(t){this.doc!==null?tt(this.doc,n=>{mn(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?tt(this.doc,r=>{Yr(r,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return Jr(this,t)}getAttributes(){return xs(this)}_write(t){t.writeTypeRef(Za)}}const xa=e=>new Jt;class ir{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===Le||n.constructor===pe)&&n._start!==null)t=n._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class pe extends dt{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new pe}clone(){const t=new pe;return t.insert(0,this.toArray().map(n=>n instanceof dt?n.clone():n)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new ir(this,t)}querySelector(t){t=t.toUpperCase();const r=new ir(this,s=>s.nodeName&&s.nodeName.toUpperCase()===t).next();return r.done?null:r.value}querySelectorAll(t){return t=t.toUpperCase(),Ht(new ir(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){qn(this,t,new Fa(this,n,t))}toString(){return Ds(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},r){const s=t.createDocumentFragment();return r!==void 0&&r._createAssociation(s,this),Je(this,o=>{s.insertBefore(o.toDOM(t,n,r),null)}),s}insert(t,n){this.doc!==null?tt(this.doc,r=>{Ls(r,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)tt(this.doc,r=>{const s=t&&t instanceof dt?t._item:t;wn(r,this,s,n)});else{const r=this._prelimContent,s=t===null?0:r.findIndex(o=>o===t)+1;if(s===0&&t!==null)throw Ft("Reference item not found");r.splice(s,0,...n)}}delete(t,n=1){this.doc!==null?tt(this.doc,r=>{Ns(r,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return Ts(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Is(this,t)}slice(t=0,n=this.length){return As(this,t,n)}forEach(t){Je(this,t)}_write(t){t.writeTypeRef(tl)}}const Ma=e=>new pe;class Le extends pe{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((r,s)=>{this.setAttribute(s,r)}),this._prelimAttrs=null}_copy(){return new Le(this.nodeName)}clone(){const t=new Le(this.nodeName),n=this.getAttributes();return dc(n,(r,s)=>{typeof r=="string"&&t.setAttribute(s,r)}),t.insert(0,this.toArray().map(r=>r instanceof dt?r.clone():r)),t}toString(){const t=this.getAttributes(),n=[],r=[];for(const l in t)r.push(l);r.sort();const s=r.length;for(let l=0;l<s;l++){const h=r[l];n.push(h+'="'+t[h]+'"')}const o=this.nodeName.toLocaleLowerCase(),a=n.length>0?" "+n.join(" "):"";return`<${o}${a}>${super.toString()}</${o}>`}removeAttribute(t){this.doc!==null?tt(this.doc,n=>{mn(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?tt(this.doc,r=>{Yr(r,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return Jr(this,t)}hasAttribute(t){return Ms(this,t)}getAttributes(t){return t?ka(this,t):xs(this)}toDOM(t=document,n={},r){const s=t.createElement(this.nodeName),o=this.getAttributes();for(const a in o){const l=o[a];typeof l=="string"&&s.setAttribute(a,l)}return Je(this,a=>{s.appendChild(a.toDOM(t,n,r))}),r!==void 0&&r._createAssociation(s,this),s}_write(t){t.writeTypeRef(Qa),t.writeKey(this.nodeName)}}const Ua=e=>new Le(e.readKey());class Fa extends Vn{constructor(t,n,r){super(t,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(s=>{s===null?this.childListChanged=!0:this.attributesChanged.add(s)})}}class _n extends Ot{constructor(t){super(),this.hookName=t}_copy(){return new _n(this.hookName)}clone(){const t=new _n(this.hookName);return this.forEach((n,r)=>{t.set(r,n)}),t}toDOM(t=document,n={},r){const s=n[this.hookName];let o;return s!==void 0?o=s.createDom(this):o=document.createElement(this.hookName),o.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(o,this),o}_write(t){t.writeTypeRef(el),t.writeKey(this.hookName)}}const Pa=e=>new _n(e.readKey());class bn extends Jt{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new bn}clone(){const t=new bn;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,r){const s=t.createTextNode(this.toString());return r!==void 0&&r._createAssociation(s,this),s}toString(){return this.toDelta().map(t=>{const n=[];for(const s in t.attributes){const o=[];for(const a in t.attributes[s])o.push({key:a,value:t.attributes[s][a]});o.sort((a,l)=>a.key<l.key?-1:1),n.push({nodeName:s,attrs:o})}n.sort((s,o)=>s.nodeName<o.nodeName?-1:1);let r="";for(let s=0;s<n.length;s++){const o=n[s];r+=`<${o.nodeName}`;for(let a=0;a<o.attrs.length;a++){const l=o.attrs[a];r+=` ${l.key}="${l.value}"`}r+=">"}r+=t.insert;for(let s=n.length-1;s>=0;s--)r+=`</${n[s].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(nl)}}const Ba=e=>new bn;class Gr{constructor(t,n){this.id=t,this.length=n}get deleted(){throw Mt()}mergeWith(t){return!1}write(t,n,r){throw Mt()}integrate(t,n){throw Mt()}}const ja=0;class vt extends Gr{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),vs(t.doc.store,this)}write(t,n){t.writeInfo(ja),t.writeLen(this.length-n)}getMissing(t,n){return null}}class nn{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new nn(this.content)}splice(t){throw Mt()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}}const Va=e=>new nn(e.readBuf());class Ge{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Ge(this.len)}splice(t){const n=new Ge(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){gn(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}}const Wa=e=>new Ge(e.readLen()),js=(e,t)=>new _e({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class rn{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new rn(js(this.doc.guid,this.opts))}splice(t){throw Mt()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const qa=e=>new rn(js(e.readString(),e.readAny()));class be{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new be(this.embed)}splice(t){throw Mt()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}}const za=e=>new be(e.readJSON());class ct{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ct(this.key,this.value)}splice(t){throw Mt()}mergeWith(t){return!1}integrate(t,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const Ha=e=>new ct(e.readKey(),e.readJSON());class vn{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new vn(this.arr)}splice(t){const n=new vn(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let s=n;s<r;s++){const o=this.arr[s];t.writeString(o===void 0?"undefined":JSON.stringify(o))}}getRef(){return 2}}const Ya=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const s=e.readString();s==="undefined"?n.push(void 0):n.push(JSON.parse(s))}return new vn(n)};class ge{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ge(this.arr)}splice(t){const n=new ge(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const r=this.arr.length;t.writeLen(r-n);for(let s=n;s<r;s++){const o=this.arr[s];t.writeAny(o)}}getRef(){return 8}}const Ja=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new ge(n)};class jt{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new jt(this.str)}splice(t){const n=new jt(this.str.slice(t));this.str=this.str.slice(0,t);const r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"�",n.str="�"+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const Ga=e=>new jt(e.readString()),$a=[Aa,Da,xa,Ua,Ma,Pa,Ba],Ka=0,Xa=1,Za=2,Qa=3,tl=4,el=5,nl=6;class $t{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new $t(this.type._copy())}splice(t){throw Mt()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(t.beforeState.get(r.id.client)||0)&&t._mergeStructs.push(r):r.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(t,!0),r=r.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}}const rl=e=>new $t($a[e.readTypeRef()](e)),En=(e,t,n)=>{const{client:r,clock:s}=t.id,o=new ot(X(r,s+n),t,X(r,s+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&o.markDeleted(),t.keep&&(o.keep=!0),t.redone!==null&&(o.redone=X(t.redone.client,t.redone.clock+n)),t.right=o,o.right!==null&&(o.right.left=o),e._mergeStructs.push(o),o.parentSub!==null&&o.right===null&&o.parent._map.set(o.parentSub,o),t.length=n,o};class ot extends Gr{constructor(t,n,r,s,o,a,l,h){super(t,h.getLength()),this.origin=r,this.left=n,this.right=s,this.rightOrigin=o,this.parent=a,this.parentSub=l,this.redone=null,this.content=h,this.info=this.content.isCountable()?ii:0}set marker(t){(this.info&Xn)>0!==t&&(this.info^=Xn)}get marker(){return(this.info&Xn)>0}get keep(){return(this.info&ri)>0}set keep(t){this.keep!==t&&(this.info^=ri)}get countable(){return(this.info&ii)>0}get deleted(){return(this.info&Kn)>0}set deleted(t){this.deleted!==t&&(this.info^=Kn)}markDeleted(){this.info|=Kn}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=ut(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=ut(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Re&&this.id.client!==this.parent.client&&this.parent.clock>=ut(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=bi(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=ie(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===vt||this.right&&this.right.constructor===vt)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===ot&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===ot&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Re){const r=nr(n,this.parent);r.constructor===vt?this.parent=null:this.parent=r.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=bi(t,t.doc.store,X(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,s;if(r!==null)s=r.right;else if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start;const o=new Set,a=new Set;for(;s!==null&&s!==this.right;){if(a.add(s),o.add(s),sn(this.origin,s.origin)){if(s.id.client<this.id.client)r=s,o.clear();else if(sn(this.rightOrigin,s.rightOrigin))break}else if(s.origin!==null&&a.has(nr(t.doc.store,s.origin)))o.has(nr(t.doc.store,s.origin))||(r=s,o.clear());else break;s=s.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),vs(t.doc.store,this),this.content.integrate(t,this),Ei(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new vt(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:X(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&sn(t.origin,this.lastId)&&this.right===t&&sn(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===t&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),gn(t.deleteSet,this.id.client,this.id.clock,this.length),Ei(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw Pt();this.content.gc(t),n?la(t,this,new vt(this.id,this.length)):this.content=new Ge(this.length)}write(t,n){const r=n>0?X(this.id.client,this.id.clock+n-1):this.origin,s=this.rightOrigin,o=this.parentSub,a=this.content.getRef()&Un|(r===null?0:wt)|(s===null?0:qt)|(o===null?0:qe);if(t.writeInfo(a),r!==null&&t.writeLeftID(r),s!==null&&t.writeRightID(s),r===null&&s===null){const l=this.parent;if(l._item!==void 0){const h=l._item;if(h===null){const p=ca(l);t.writeParentInfo(!0),t.writeString(p)}else t.writeParentInfo(!1),t.writeLeftID(h.id)}else l.constructor===String?(t.writeParentInfo(!0),t.writeString(l)):l.constructor===Re?(t.writeParentInfo(!1),t.writeLeftID(l)):Pt();o!==null&&t.writeString(o)}this.content.write(t,n)}}const Vs=(e,t)=>il[t&Un](e),il=[()=>{Pt()},Wa,Ya,Va,Ga,za,Ha,rl,Ja,qa,()=>{Pt()}],sl=10;class Et extends Gr{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){Pt()}write(t,n){t.writeInfo(sl),W(t.restEncoder,this.length-n)}getMissing(t,n){return null}}const Ws=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},qs="__ $YJS$ __";Ws[qs]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Ws[qs]=!0;const zs="YJS_VUE";function ol(e){const{doc:t}=e||{},n=go(t)?t.value:t,s={doc:We(n||new _e),providers:new Map};return yo(zs,s),s}function Hs(){const e=wo(zs);if(!e)throw new Error("Could not retrieve document context. Please wrap in a DocumentProvider.");return e}const cl=Fi({props:{doc:{type:Object,default:()=>new _e},scope:{type:String}},setup(e,{slots:t}){const n=ol({doc:Dt(()=>e.doc)});return Pi(()=>{n.providers.forEach(r=>{r.forEach(s=>s.destroy())})}),()=>{var r;return(r=t.default)==null?void 0:r.call(t)}}});var mr=(e=>(e.Websocket="WEBSOCKET",e.Webrtc="WEBRTC",e.Indexeddb="INDEXEDDB",e))(mr||{});function zn(){const{doc:e}=Hs();return Mn(e,(t,n)=>{n==null||n.destroy()}),e}const Ys=e=>JSON.parse(JSON.stringify(e));function Js(e){return typeof e=="function"}function Ai(e,t){return[e,t].join("_")}function nh(e){const t=We(new Map),n=We({}),r=Dt(()=>Bi(e)),s=a=>{r.value&&(r.value.setLocalState(a),n.value=a)},o=()=>{r.value&&(t.value=new Map(Array.from(r.value.getStates()).map(([a,l])=>[a,l])))};return mo(()=>{var a;(a=r.value)==null||a.on("change",o)}),Pi(()=>{var a;(a=r.value)==null||a.off("change",o)}),{states:Dt(()=>t.value),localID:Dt(()=>{var a;return(a=r.value)==null?void 0:a.clientID}),localState:Dt(()=>n.value),setLocalState:s}}var K=(e=>(e.NONE="none",e.INSERT="insert",e.UPDATE="update",e.DELETE="delete",e.PENDING="pending",e))(K||{});function Sn(e){return Cn(e)||kn(e)||e instanceof Object}function Cn(e){return Array.isArray(e)}function kn(e){return typeof e=="string"}function Ti(e){return!Cn(e)&&!kn(e)}function $e(e,t){return kn(e)&&kn(t)?al(e,t):Cn(e)&&Cn(t)?ll(e,t):Ti(e)&&Ti(t)?hl(e,t):[]}function al(e,t){if(e===t)return[];if(e.length===0)return t.split("").map((n,r)=>[K.INSERT,r,n]);if(t.length===0)return e.split("").map(()=>[K.DELETE,0,void 0]);if(ul(e,t)){const n=e.length,r=t.length,s=n>=r;return s?Di(t,e,s):Di(e,t,s)}else{const n=e.split("").map(()=>[K.DELETE,0,void 0]),r=t.split("").map((s,o)=>[K.INSERT,o,s]);return n.concat(r)}}function ll(e,t){const n=[];let r=0,s=0;for(let o=0;o<e.length;o++){const a=e[o],l=o+s;if(t[l]===void 0)n.push([K.DELETE,o,void 0]);else if(Sn(a)&&Sn(t[l])){const h=$e(a,t[l]),p=typeof t[l+1]>"u"?[]:$e(a,t[l+1]);typeof t[l+1]<"u"&&p.length===0?(n.push([K.INSERT,o,t[l]]),r+=2,s++):(h.length!==0&&n.push([K.PENDING,o,h]),r++)}else a!==t[l]&&a===t[l+1]?(n.push([K.INSERT,l,t[l]]),r+=2,s++):(a!==t[l]&&a!==t[l+1]&&n.push([K.UPDATE,l,t[l]]),r++)}return r<t.length&&t.slice(e.length).forEach((o,a)=>n.push([K.INSERT,r+a,o])),n}function hl(e,t){const n=[];return Object.entries(e).forEach(([r,s])=>{!(r in t)&&!(s instanceof Function)&&n.push([K.DELETE,r,void 0])}),Object.entries(t).forEach(([r,s])=>{if(!(r in e))n.push([K.INSERT,r,s]);else if(Sn(e[r])&&Sn(s)){const o=$e(e[r],s);o.length!==0&&n.push([K.PENDING,r,o])}else e[r]!==s&&n.push([K.UPDATE,r,s])}),n}function ul(e,t){const n=e.split(""),r=t.split("");let s=!1;for(const o of n)s=s||r.includes(o);return s}function Di(e,t,n){const r=e.length,s=t.length,o=r,a=s-r,l=r+s+1,h=[];for(let y=0;y<l;y++)h[y]=-1;const p=[];for(let y=0;y<l;y++)p[y]=-1;const m=[],u=(y,b,v)=>{let R=Math.max(b,v),S=R-y;for(;S<r&&R<s&&e[S]===t[R];)S++,R++;return p[y+o]=m.length,m[m.length]={x:S,y:R,k:b>v?p[y+o-1]:p[y+o+1]},R};let d=-1;do{d++;for(let y=-d;y<a;y++)h[y+o]=u(y,h[y+o-1]+1,h[y+o+1]);for(let y=a+d;y>a;y--)h[y+o]=u(y,h[y+o-1]+1,h[y+o+1]);h[a+o]=u(a,h[a+o-1]+1,h[a+o+1])}while(h[a+o]!==s);let w=p[a+o];const g=[];for(;w!==-1;)g[g.length]={x:m[w].x,y:m[w].y},w=m[w].k;const E=[];let x=0,O=0,M=-1;for(let y=g.length-1;y>=0;y--)for(;x<=g[y].x||O<=g[y].y;)g[y].y-g[y].x>O-x?(n?E[E.length]=[K.DELETE,M,void 0]:(E[E.length]=[K.INSERT,M,t[O-1]],M++),O++):g[y].y-g[y].x<O-x?(n?(E[E.length]=[K.INSERT,M,e[x-1]],M++):E[E.length]=[K.DELETE,M,void 0],x++):(x++,O++,M++);return E}function Rn(e){const t=new It;return e.forEach(n=>{Array.isArray(n)?t.push([Rn(n)]):n instanceof Object?t.push([An(n)]):typeof n=="string"?t.push([Tn(n)]):t.push([n])}),t}function An(e){const t=new Ot;return Object.entries(e).forEach(([n,r])=>{Array.isArray(r)?t.set(n,Rn(r)):r instanceof Object?t.set(n,An(r)):typeof r=="string"?t.set(n,Tn(r)):t.set(n,r)}),t}function Tn(e){return new Jt(e)}function $r(e,t){$e(e.toJSON(),t).forEach(([n,r,s])=>{switch(n){case K.INSERT:case K.UPDATE:if(!(s instanceof Function))if(e instanceof Ot)typeof s=="string"?e.set(r,Tn(s)):Array.isArray(s)?e.set(r,Rn(s)):s instanceof Object?e.set(r,An(s)):e.set(r,s);else if(e instanceof It){const o=r;n===K.UPDATE&&e.delete(o),typeof s=="string"?e.insert(o,[Tn(s)]):Array.isArray(s)?e.insert(o,[Rn(s)]):s instanceof Object?e.insert(o,[An(s)]):e.insert(o,[s])}else e instanceof Jt&&e.insert(r,s);break;case K.DELETE:if(e instanceof Ot)e.delete(r);else if(e instanceof It){const o=r;e.delete(e.length<=o?e.length-1:o)}else e instanceof Jt&&e.delete(r,1);break;case K.PENDING:(e instanceof Ot||e instanceof It)&&$r(e.get(r),t[r]);break}})}function fl(e,t){const n=$e(e,t),r=(l,h)=>{if(typeof l=="string")return a(l,h);if(Array.isArray(l))return s(l,h);if(l instanceof Object)return o(l,h)},s=(l,h)=>h.sort(([,p],[,m])=>Math.sign(p-m)).reduce((p,[m,u,d])=>{switch(m){case K.INSERT:return p.splice(u,0,d),p;case K.UPDATE:return p[u]=d,p;case K.PENDING:return p[u]=r(l[u],d),p;case K.DELETE:return p.splice(u,1),p;case K.NONE:default:return p}},l),o=(l,h)=>h.reduce((p,[m,u,d])=>{switch(m){case K.INSERT:case K.UPDATE:return p[u]=d,p;case K.PENDING:return p[u]=r(l[u],d),p;case K.DELETE:return delete p[u],p;case K.NONE:default:return p}},l),a=(l,h)=>h.reduce((p,[m,u,d])=>{switch(m){case K.INSERT:{const w=p.slice(0,u),g=p.slice(u);return w+d+g}case K.DELETE:{const w=p.slice(0,u),g=p.slice(u+1);return w+g}default:return p}},l);return n.length===0?e:r(e,n)}var Gs=Symbol.for("immer-nothing"),Ii=Symbol.for("immer-draftable"),_t=Symbol.for("immer-state");function Tt(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ne=Object.getPrototypeOf;function xe(e){return!!e&&!!e[_t]}function ye(e){var t;return e?$s(e)||Array.isArray(e)||!!e[Ii]||!!((t=e.constructor)!=null&&t[Ii])||Yn(e)||Jn(e):!1}var dl=Object.prototype.constructor.toString();function $s(e){if(!e||typeof e!="object")return!1;const t=Ne(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===dl}function Dn(e,t){Hn(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function Hn(e){const t=e[_t];return t?t.type_:Array.isArray(e)?1:Yn(e)?2:Jn(e)?3:0}function _r(e,t){return Hn(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ks(e,t,n){const r=Hn(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function pl(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Yn(e){return e instanceof Map}function Jn(e){return e instanceof Set}function ae(e){return e.copy_||e.base_}function br(e,t){if(Yn(e))return new Map(e);if(Jn(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&$s(e))return Ne(e)?{...e}:Object.assign(Object.create(null),e);const n=Object.getOwnPropertyDescriptors(e);delete n[_t];let r=Reflect.ownKeys(n);for(let s=0;s<r.length;s++){const o=r[s],a=n[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[o]})}return Object.create(Ne(e),n)}function Kr(e,t=!1){return Gn(e)||xe(e)||!ye(e)||(Hn(e)>1&&(e.set=e.add=e.clear=e.delete=gl),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>Kr(r,!0))),e}function gl(){Tt(2)}function Gn(e){return Object.isFrozen(e)}var yl={};function we(e){const t=yl[e];return t||Tt(0,e),t}var Ke;function Xs(){return Ke}function wl(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Oi(e,t){t&&(we("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function vr(e){Er(e),e.drafts_.forEach(ml),e.drafts_=null}function Er(e){e===Ke&&(Ke=e.parent_)}function Li(e){return Ke=wl(Ke,e)}function ml(e){const t=e[_t];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Ni(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[_t].modified_&&(vr(t),Tt(4)),ye(e)&&(e=In(t,e),t.parent_||On(t,e)),t.patches_&&we("Patches").generateReplacementPatches_(n[_t].base_,e,t.patches_,t.inversePatches_)):e=In(t,n,[]),vr(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Gs?e:void 0}function In(e,t,n){if(Gn(t))return t;const r=t[_t];if(!r)return Dn(t,(s,o)=>xi(e,r,t,s,o,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return On(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,a=!1;r.type_===3&&(o=new Set(s),s.clear(),a=!0),Dn(o,(l,h)=>xi(e,r,s,l,h,n,a)),On(e,s,!1),n&&e.patches_&&we("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function xi(e,t,n,r,s,o,a){if(xe(s)){const l=o&&t&&t.type_!==3&&!_r(t.assigned_,r)?o.concat(r):void 0,h=In(e,s,l);if(Ks(n,r,h),xe(h))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(ye(s)&&!Gn(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;In(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&On(e,s)}}function On(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Kr(t,n)}function _l(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:Xs(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,o=Xr;n&&(s=[r],o=Xe);const{revoke:a,proxy:l}=Proxy.revocable(s,o);return r.draft_=l,r.revoke_=a,l}var Xr={get(e,t){if(t===_t)return e;const n=ae(e);if(!_r(n,t))return bl(e,n,t);const r=n[t];return e.finalized_||!ye(r)?r:r===sr(e.base_,t)?(or(e),e.copy_[t]=Cr(r,e)):r},has(e,t){return t in ae(e)},ownKeys(e){return Reflect.ownKeys(ae(e))},set(e,t,n){const r=Zs(ae(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=sr(ae(e),t),o=s==null?void 0:s[_t];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(pl(n,s)&&(n!==void 0||_r(e.base_,t)))return!0;or(e),Sr(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return sr(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,or(e),Sr(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=ae(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){Tt(11)},getPrototypeOf(e){return Ne(e.base_)},setPrototypeOf(){Tt(12)}},Xe={};Dn(Xr,(e,t)=>{Xe[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Xe.deleteProperty=function(e,t){return Xe.set.call(this,e,t,void 0)};Xe.set=function(e,t,n){return Xr.set.call(this,e[0],t,n,e[0])};function sr(e,t){const n=e[_t];return(n?ae(n):e)[t]}function bl(e,t,n){var r;const s=Zs(t,n);return s?"value"in s?s.value:(r=s.get)==null?void 0:r.call(e.draft_):void 0}function Zs(e,t){if(!(t in e))return;let n=Ne(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Ne(n)}}function Sr(e){e.modified_||(e.modified_=!0,e.parent_&&Sr(e.parent_))}function or(e){e.copy_||(e.copy_=br(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var vl=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const o=n;n=t;const a=this;return function(h=o,...p){return a.produce(h,m=>n.call(this,m,...p))}}typeof n!="function"&&Tt(6),r!==void 0&&typeof r!="function"&&Tt(7);let s;if(ye(t)){const o=Li(this),a=Cr(t,void 0);let l=!0;try{s=n(a),l=!1}finally{l?vr(o):Er(o)}return Oi(o,r),Ni(s,o)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===Gs&&(s=void 0),this.autoFreeze_&&Kr(s,!0),r){const o=[],a=[];we("Patches").generateReplacementPatches_(t,s,o,a),r(o,a)}return s}else Tt(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...l)=>this.produceWithPatches(a,h=>t(h,...l));let r,s;return[this.produce(t,n,(a,l)=>{r=a,s=l}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ye(e)||Tt(8),xe(e)&&(e=El(e));const t=Li(this),n=Cr(e,void 0);return n[_t].isManual_=!0,Er(t),n}finishDraft(e,t){const n=e&&e[_t];(!n||!n.isManual_)&&Tt(9);const{scope_:r}=n;return Oi(r,t),Ni(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=we("Patches").applyPatches_;return xe(e)?r(e,t):this.produce(e,s=>r(s,t))}};function Cr(e,t){const n=Yn(e)?we("MapSet").proxyMap_(e,t):Jn(e)?we("MapSet").proxySet_(e,t):_l(e,t);return(t?t.scope_:Xs()).drafts_.push(n),n}function El(e){return xe(e)||Tt(10,e),Qs(e)}function Qs(e){if(!ye(e)||Gn(e))return e;const t=e[_t];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=br(e,t.scope_.immer_.useStrictShallowCopy_)}else n=br(e,!0);return Dn(n,(r,s)=>{Ks(n,r,Qs(s))}),t&&(t.finalized_=!1),n}var bt=new vl,Sl=bt.produce;bt.produceWithPatches.bind(bt);bt.setAutoFreeze.bind(bt);bt.setUseStrictShallowCopy.bind(bt);bt.applyPatches.bind(bt);bt.createDraft.bind(bt);bt.finishDraft.bind(bt);function to(e){const t=We(e);return[t,r=>{t.value=Sl(t.value,s=>{if(Js(r))r(s);else return r})}]}const Cl="Y_SYNC_STORE";function eo(e,t){const n=zn();return Dt(()=>{const r=n.value.getMap(Cl),s=r.get(e);if(!s&&t){const o=new t;return r.set(e,o),o}return s})}function rh(e){const t=zn(),n=eo(e,It),[r,s]=to([]),o=()=>{const a=fl(Ys(r.value),n.value.toJSON());s(a)};return Mn(r,a=>{t.value.transact(()=>{$r(n.value,a)})}),ji(()=>(n.value.observeDeep(o),()=>{n.value.unobserve(o)})),[Dt(()=>r.value),s]}function kl(e){const t=zn(),n=eo(e,Ot),[r,s]=to(n.value.toJSON());Mn(r,a=>{t.value.transact(()=>{$r(n.value,a)})});const o=()=>{s(Ys(n.value.toJSON()))};return ji(()=>(n.value.observeDeep(o),()=>{n.value.unobserve(o)})),[Dt(()=>r.value),s]}const Rl="YJS_VUE___RECORD";function ih(e){const[t,n]=kl(Rl),r=Dt(()=>t.value[e]);function s(o){n(a=>{Js(o)?o(a[e]):a[e]=o})}return[r,s]}const sh=Fi({__name:"index",setup(e){return(t,n)=>(_o(),bo(Co(cl),null,{default:vo(()=>[Eo("div",null,[So(t.$slots,"default")])]),_:3}))}}),Al=1200,Tl=2500,Ln=3e4,kr=e=>{if(e.shouldConnect&&e.ws===null){const t=new WebSocket(e.url),n=e.binaryType;let r=null;n&&(t.binaryType=n),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=a=>{e.lastMessageReceived=Yt();const l=a.data,h=typeof l=="string"?JSON.parse(l):l;h&&h.type==="pong"&&(clearTimeout(r),r=setTimeout(o,Ln/2)),e.emit("message",[h,e])};const s=a=>{e.ws!==null&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:a},e])):e.unsuccessfulReconnects++,setTimeout(kr,Tr(Do(e.unsuccessfulReconnects+1)*Al,Tl),e)),clearTimeout(r)},o=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>s(null),t.onerror=a=>s(a),t.onopen=()=>{e.lastMessageReceived=Yt(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),r=setTimeout(o,Ln/2)}}};class Dl extends Wi{constructor(t,{binaryType:n}={}){super(),this.url=t,this.ws=null,this.binaryType=n||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&Ln<Yt()-this.lastMessageReceived&&this.ws.close()},Ln/2),kr(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&kr(this)}}const no=new Map;class Il{constructor(t){this.room=t,this.onmessage=null,this._onChange=n=>n.key===t&&this.onmessage!==null&&this.onmessage({data:ns(n.newValue||"")}),lc(this._onChange)}postMessage(t){Ki.setItem(this.room,es(kc(t)))}close(){hc(this._onChange)}}const Ol=typeof BroadcastChannel>"u"?Il:BroadcastChannel,Zr=e=>mt(no,e,()=>{const t=re(),n=new Ol(e);return n.onmessage=r=>t.forEach(s=>s(r.data,"broadcastchannel")),{bc:n,subs:t}}),Ll=(e,t)=>(Zr(e).subs.add(t),t),Nl=(e,t)=>{const n=Zr(e),r=n.subs.delete(t);return r&&n.subs.size===0&&(n.bc.close(),no.delete(e)),r},xl=(e,t,n=null)=>{const r=Zr(e);r.bc.postMessage(t),r.subs.forEach(s=>s(t,n))},Ml=()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else n!==void 0&&n()}};var Nt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ul(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function an(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ro={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){var n=Math.floor,r=Math.abs,s=Math.pow;return function(){function o(a,l,h){function p(d,w){if(!l[d]){if(!a[d]){var g=typeof an=="function"&&an;if(!w&&g)return g(d,!0);if(m)return m(d,!0);var E=new Error("Cannot find module '"+d+"'");throw E.code="MODULE_NOT_FOUND",E}var x=l[d]={exports:{}};a[d][0].call(x.exports,function(O){var M=a[d][1][O];return p(M||O)},x,x.exports,o,a,l,h)}return l[d].exports}for(var m=typeof an=="function"&&an,u=0;u<h.length;u++)p(h[u]);return p}return o}()({1:[function(o,a,l){function h(b){var v=b.length;if(0<v%4)throw new Error("Invalid string. Length must be a multiple of 4");var R=b.indexOf("=");R===-1&&(R=v);var S=R===v?0:4-R%4;return[R,S]}function p(b,v,R){return 3*(v+R)/4-R}function m(b){var v,R,S=h(b),I=S[0],U=S[1],k=new x(p(b,I,U)),T=0,F=0<U?I-4:I;for(R=0;R<F;R+=4)v=E[b.charCodeAt(R)]<<18|E[b.charCodeAt(R+1)]<<12|E[b.charCodeAt(R+2)]<<6|E[b.charCodeAt(R+3)],k[T++]=255&v>>16,k[T++]=255&v>>8,k[T++]=255&v;return U===2&&(v=E[b.charCodeAt(R)]<<2|E[b.charCodeAt(R+1)]>>4,k[T++]=255&v),U===1&&(v=E[b.charCodeAt(R)]<<10|E[b.charCodeAt(R+1)]<<4|E[b.charCodeAt(R+2)]>>2,k[T++]=255&v>>8,k[T++]=255&v),k}function u(b){return g[63&b>>18]+g[63&b>>12]+g[63&b>>6]+g[63&b]}function d(b,v,R){for(var S,I=[],U=v;U<R;U+=3)S=(16711680&b[U]<<16)+(65280&b[U+1]<<8)+(255&b[U+2]),I.push(u(S));return I.join("")}function w(b){for(var v,R=b.length,S=R%3,I=[],U=16383,k=0,T=R-S;k<T;k+=U)I.push(d(b,k,k+U>T?T:k+U));return S===1?(v=b[R-1],I.push(g[v>>2]+g[63&v<<4]+"==")):S===2&&(v=(b[R-2]<<8)+b[R-1],I.push(g[v>>10]+g[63&v>>4]+g[63&v<<2]+"=")),I.join("")}l.byteLength=function(b){var v=h(b),R=v[0],S=v[1];return 3*(R+S)/4-S},l.toByteArray=m,l.fromByteArray=w;for(var g=[],E=[],x=typeof Uint8Array>"u"?Array:Uint8Array,O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M=0,y=O.length;M<y;++M)g[M]=O[M],E[O.charCodeAt(M)]=M;E[45]=62,E[95]=63},{}],2:[function(){},{}],3:[function(o,a,l){(function(){(function(){var h=String.fromCharCode,p=Math.min;function m(i){if(2147483647<i)throw new RangeError('The value "'+i+'" is invalid for option "size"');var c=new Uint8Array(i);return c.__proto__=u.prototype,c}function u(i,c,f){if(typeof i=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return E(i)}return d(i,c,f)}function d(i,c,f){if(typeof i=="string")return x(i,c);if(ArrayBuffer.isView(i))return O(i);if(i==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i);if(D(i,ArrayBuffer)||i&&D(i.buffer,ArrayBuffer))return M(i,c,f);if(typeof i=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var C=i.valueOf&&i.valueOf();if(C!=null&&C!==i)return u.from(C,c,f);var A=y(i);if(A)return A;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof i[Symbol.toPrimitive]=="function")return u.from(i[Symbol.toPrimitive]("string"),c,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i)}function w(i){if(typeof i!="number")throw new TypeError('"size" argument must be of type number');if(0>i)throw new RangeError('The value "'+i+'" is invalid for option "size"')}function g(i,c,f){return w(i),0>=i||c===void 0?m(i):typeof f=="string"?m(i).fill(c,f):m(i).fill(c)}function E(i){return w(i),m(0>i?0:0|b(i))}function x(i,c){if((typeof c!="string"||c==="")&&(c="utf8"),!u.isEncoding(c))throw new TypeError("Unknown encoding: "+c);var f=0|v(i,c),C=m(f),A=C.write(i,c);return A!==f&&(C=C.slice(0,A)),C}function O(i){for(var c=0>i.length?0:0|b(i.length),f=m(c),C=0;C<c;C+=1)f[C]=255&i[C];return f}function M(i,c,f){if(0>c||i.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<c+(f||0))throw new RangeError('"length" is outside of buffer bounds');var C;return C=c===void 0&&f===void 0?new Uint8Array(i):f===void 0?new Uint8Array(i,c):new Uint8Array(i,c,f),C.__proto__=u.prototype,C}function y(i){if(u.isBuffer(i)){var c=0|b(i.length),f=m(c);return f.length===0||i.copy(f,0,0,c),f}return i.length===void 0?i.type==="Buffer"&&Array.isArray(i.data)?O(i.data):void 0:typeof i.length!="number"||L(i.length)?m(0):O(i)}function b(i){if(i>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|i}function v(i,c){if(u.isBuffer(i))return i.length;if(ArrayBuffer.isView(i)||D(i,ArrayBuffer))return i.byteLength;if(typeof i!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof i);var f=i.length,C=2<arguments.length&&arguments[2]===!0;if(!C&&f===0)return 0;for(var A=!1;;)switch(c){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return oe(i).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*f;case"hex":return f>>>1;case"base64":return Rt(i).length;default:if(A)return C?-1:oe(i).length;c=(""+c).toLowerCase(),A=!0}}function R(i,c,f){var C=!1;if((c===void 0||0>c)&&(c=0),c>this.length||((f===void 0||f>this.length)&&(f=this.length),0>=f)||(f>>>=0,c>>>=0,f<=c))return"";for(i||(i="utf8");;)switch(i){case"hex":return Ct(this,c,f);case"utf8":case"utf-8":return st(this,c,f);case"ascii":return q(this,c,f);case"latin1":case"binary":return ve(this,c,f);case"base64":return Z(this,c,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Kt(this,c,f);default:if(C)throw new TypeError("Unknown encoding: "+i);i=(i+"").toLowerCase(),C=!0}}function S(i,c,f){var C=i[c];i[c]=i[f],i[f]=C}function I(i,c,f,C,A){if(i.length===0)return-1;if(typeof f=="string"?(C=f,f=0):2147483647<f?f=2147483647:-2147483648>f&&(f=-2147483648),f=+f,L(f)&&(f=A?0:i.length-1),0>f&&(f=i.length+f),f>=i.length){if(A)return-1;f=i.length-1}else if(0>f)if(A)f=0;else return-1;if(typeof c=="string"&&(c=u.from(c,C)),u.isBuffer(c))return c.length===0?-1:U(i,c,f,C,A);if(typeof c=="number")return c&=255,typeof Uint8Array.prototype.indexOf=="function"?A?Uint8Array.prototype.indexOf.call(i,c,f):Uint8Array.prototype.lastIndexOf.call(i,c,f):U(i,[c],f,C,A);throw new TypeError("val must be string, number or Buffer")}function U(i,c,f,C,A){function N(Ee,Be){return j===1?Ee[Be]:Ee.readUInt16BE(Be*j)}var j=1,G=i.length,et=c.length;if(C!==void 0&&(C=(C+"").toLowerCase(),C==="ucs2"||C==="ucs-2"||C==="utf16le"||C==="utf-16le")){if(2>i.length||2>c.length)return-1;j=2,G/=2,et/=2,f/=2}var $;if(A){var J=-1;for($=f;$<G;$++)if(N(i,$)!==N(c,J===-1?0:$-J))J!==-1&&($-=$-J),J=-1;else if(J===-1&&(J=$),$-J+1===et)return J*j}else for(f+et>G&&(f=G-et),$=f;0<=$;$--){for(var ft=!0,ce=0;ce<et;ce++)if(N(i,$+ce)!==N(c,ce)){ft=!1;break}if(ft)return $}return-1}function k(i,c,f,C){f=+f||0;var A=i.length-f;C?(C=+C,C>A&&(C=A)):C=A;var N=c.length;C>N/2&&(C=N/2);for(var j,G=0;G<C;++G){if(j=parseInt(c.substr(2*G,2),16),L(j))return G;i[f+G]=j}return G}function T(i,c,f,C){return At(oe(c,i.length-f),i,f,C)}function F(i,c,f,C){return At(Pe(c),i,f,C)}function B(i,c,f,C){return F(i,c,f,C)}function z(i,c,f,C){return At(Rt(c),i,f,C)}function Y(i,c,f,C){return At(Qt(c,i.length-f),i,f,C)}function Z(i,c,f){return c===0&&f===i.length?P.fromByteArray(i):P.fromByteArray(i.slice(c,f))}function st(i,c,f){f=p(i.length,f);for(var C=[],A=c;A<f;){var N=i[A],j=null,G=239<N?4:223<N?3:191<N?2:1;if(A+G<=f){var et,$,J,ft;G===1?128>N&&(j=N):G===2?(et=i[A+1],(192&et)==128&&(ft=(31&N)<<6|63&et,127<ft&&(j=ft))):G===3?(et=i[A+1],$=i[A+2],(192&et)==128&&(192&$)==128&&(ft=(15&N)<<12|(63&et)<<6|63&$,2047<ft&&(55296>ft||57343<ft)&&(j=ft))):G===4&&(et=i[A+1],$=i[A+2],J=i[A+3],(192&et)==128&&(192&$)==128&&(192&J)==128&&(ft=(15&N)<<18|(63&et)<<12|(63&$)<<6|63&J,65535<ft&&1114112>ft&&(j=ft)))}j===null?(j=65533,G=1):65535<j&&(j-=65536,C.push(55296|1023&j>>>10),j=56320|1023&j),C.push(j),A+=G}return pt(C)}function pt(i){var c=i.length;if(c<=4096)return h.apply(String,i);for(var f="",C=0;C<c;)f+=h.apply(String,i.slice(C,C+=4096));return f}function q(i,c,f){var C="";f=p(i.length,f);for(var A=c;A<f;++A)C+=h(127&i[A]);return C}function ve(i,c,f){var C="";f=p(i.length,f);for(var A=c;A<f;++A)C+=h(i[A]);return C}function Ct(i,c,f){var C=i.length;(!c||0>c)&&(c=0),(!f||0>f||f>C)&&(f=C);for(var A="",N=c;N<f;++N)A+=se(i[N]);return A}function Kt(i,c,f){for(var C=i.slice(c,f),A="",N=0;N<C.length;N+=2)A+=h(C[N]+256*C[N+1]);return A}function rt(i,c,f){if(i%1!=0||0>i)throw new RangeError("offset is not uint");if(i+c>f)throw new RangeError("Trying to access beyond buffer length")}function Q(i,c,f,C,A,N){if(!u.isBuffer(i))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>A||c<N)throw new RangeError('"value" argument is out of bounds');if(f+C>i.length)throw new RangeError("Index out of range")}function kt(i,c,f,C){if(f+C>i.length)throw new RangeError("Index out of range");if(0>f)throw new RangeError("Index out of range")}function Xt(i,c,f,C,A){return c=+c,f>>>=0,A||kt(i,c,f,4),V.write(i,c,f,C,23,4),f+4}function Zt(i,c,f,C,A){return c=+c,f>>>=0,A||kt(i,c,f,8),V.write(i,c,f,C,52,8),f+8}function Fe(i){if(i=i.split("=")[0],i=i.trim().replace(_,""),2>i.length)return"";for(;i.length%4!=0;)i+="=";return i}function se(i){return 16>i?"0"+i.toString(16):i.toString(16)}function oe(i,c){c=c||1/0;for(var f,C=i.length,A=null,N=[],j=0;j<C;++j){if(f=i.charCodeAt(j),55295<f&&57344>f){if(!A){if(56319<f){-1<(c-=3)&&N.push(239,191,189);continue}else if(j+1===C){-1<(c-=3)&&N.push(239,191,189);continue}A=f;continue}if(56320>f){-1<(c-=3)&&N.push(239,191,189),A=f;continue}f=(A-55296<<10|f-56320)+65536}else A&&-1<(c-=3)&&N.push(239,191,189);if(A=null,128>f){if(0>(c-=1))break;N.push(f)}else if(2048>f){if(0>(c-=2))break;N.push(192|f>>6,128|63&f)}else if(65536>f){if(0>(c-=3))break;N.push(224|f>>12,128|63&f>>6,128|63&f)}else if(1114112>f){if(0>(c-=4))break;N.push(240|f>>18,128|63&f>>12,128|63&f>>6,128|63&f)}else throw new Error("Invalid code point")}return N}function Pe(i){for(var c=[],f=0;f<i.length;++f)c.push(255&i.charCodeAt(f));return c}function Qt(i,c){for(var f,C,A,N=[],j=0;j<i.length&&!(0>(c-=2));++j)f=i.charCodeAt(j),C=f>>8,A=f%256,N.push(A),N.push(C);return N}function Rt(i){return P.toByteArray(Fe(i))}function At(i,c,f,C){for(var A=0;A<C&&!(A+f>=c.length||A>=i.length);++A)c[A+f]=i[A];return A}function D(i,c){return i instanceof c||i!=null&&i.constructor!=null&&i.constructor.name!=null&&i.constructor.name===c.name}function L(i){return i!==i}var P=o("base64-js"),V=o("ieee754");l.Buffer=u,l.SlowBuffer=function(i){return+i!=i&&(i=0),u.alloc(+i)},l.INSPECT_MAX_BYTES=50,l.kMaxLength=2147483647,u.TYPED_ARRAY_SUPPORT=function(){try{var i=new Uint8Array(1);return i.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},i.foo()===42}catch{return!1}}(),u.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){return u.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return u.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192,u.from=function(i,c,f){return d(i,c,f)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,u.alloc=function(i,c,f){return g(i,c,f)},u.allocUnsafe=function(i){return E(i)},u.allocUnsafeSlow=function(i){return E(i)},u.isBuffer=function(i){return i!=null&&i._isBuffer===!0&&i!==u.prototype},u.compare=function(i,c){if(D(i,Uint8Array)&&(i=u.from(i,i.offset,i.byteLength)),D(c,Uint8Array)&&(c=u.from(c,c.offset,c.byteLength)),!u.isBuffer(i)||!u.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(i===c)return 0;for(var f=i.length,C=c.length,A=0,N=p(f,C);A<N;++A)if(i[A]!==c[A]){f=i[A],C=c[A];break}return f<C?-1:C<f?1:0},u.isEncoding=function(i){switch((i+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(i,c){if(!Array.isArray(i))throw new TypeError('"list" argument must be an Array of Buffers');if(i.length===0)return u.alloc(0);var f;if(c===void 0)for(c=0,f=0;f<i.length;++f)c+=i[f].length;var C=u.allocUnsafe(c),A=0;for(f=0;f<i.length;++f){var N=i[f];if(D(N,Uint8Array)&&(N=u.from(N)),!u.isBuffer(N))throw new TypeError('"list" argument must be an Array of Buffers');N.copy(C,A),A+=N.length}return C},u.byteLength=v,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var i=this.length;if(i%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<i;c+=2)S(this,c,c+1);return this},u.prototype.swap32=function(){var i=this.length;if(i%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<i;c+=4)S(this,c,c+3),S(this,c+1,c+2);return this},u.prototype.swap64=function(){var i=this.length;if(i%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<i;c+=8)S(this,c,c+7),S(this,c+1,c+6),S(this,c+2,c+5),S(this,c+3,c+4);return this},u.prototype.toString=function(){var i=this.length;return i===0?"":arguments.length===0?st(this,0,i):R.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(i){if(!u.isBuffer(i))throw new TypeError("Argument must be a Buffer");return this===i||u.compare(this,i)===0},u.prototype.inspect=function(){var i="",c=l.INSPECT_MAX_BYTES;return i=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(i+=" ... "),"<Buffer "+i+">"},u.prototype.compare=function(i,c,f,C,A){if(D(i,Uint8Array)&&(i=u.from(i,i.offset,i.byteLength)),!u.isBuffer(i))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof i);if(c===void 0&&(c=0),f===void 0&&(f=i?i.length:0),C===void 0&&(C=0),A===void 0&&(A=this.length),0>c||f>i.length||0>C||A>this.length)throw new RangeError("out of range index");if(C>=A&&c>=f)return 0;if(C>=A)return-1;if(c>=f)return 1;if(c>>>=0,f>>>=0,C>>>=0,A>>>=0,this===i)return 0;for(var N=A-C,j=f-c,G=p(N,j),et=this.slice(C,A),$=i.slice(c,f),J=0;J<G;++J)if(et[J]!==$[J]){N=et[J],j=$[J];break}return N<j?-1:j<N?1:0},u.prototype.includes=function(i,c,f){return this.indexOf(i,c,f)!==-1},u.prototype.indexOf=function(i,c,f){return I(this,i,c,f,!0)},u.prototype.lastIndexOf=function(i,c,f){return I(this,i,c,f,!1)},u.prototype.write=function(i,c,f,C){if(c===void 0)C="utf8",f=this.length,c=0;else if(f===void 0&&typeof c=="string")C=c,f=this.length,c=0;else if(isFinite(c))c>>>=0,isFinite(f)?(f>>>=0,C===void 0&&(C="utf8")):(C=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var A=this.length-c;if((f===void 0||f>A)&&(f=A),0<i.length&&(0>f||0>c)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");C||(C="utf8");for(var N=!1;;)switch(C){case"hex":return k(this,i,c,f);case"utf8":case"utf-8":return T(this,i,c,f);case"ascii":return F(this,i,c,f);case"latin1":case"binary":return B(this,i,c,f);case"base64":return z(this,i,c,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,i,c,f);default:if(N)throw new TypeError("Unknown encoding: "+C);C=(""+C).toLowerCase(),N=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(i,c){var f=this.length;i=~~i,c=c===void 0?f:~~c,0>i?(i+=f,0>i&&(i=0)):i>f&&(i=f),0>c?(c+=f,0>c&&(c=0)):c>f&&(c=f),c<i&&(c=i);var C=this.subarray(i,c);return C.__proto__=u.prototype,C},u.prototype.readUIntLE=function(i,c,f){i>>>=0,c>>>=0,f||rt(i,c,this.length);for(var C=this[i],A=1,N=0;++N<c&&(A*=256);)C+=this[i+N]*A;return C},u.prototype.readUIntBE=function(i,c,f){i>>>=0,c>>>=0,f||rt(i,c,this.length);for(var C=this[i+--c],A=1;0<c&&(A*=256);)C+=this[i+--c]*A;return C},u.prototype.readUInt8=function(i,c){return i>>>=0,c||rt(i,1,this.length),this[i]},u.prototype.readUInt16LE=function(i,c){return i>>>=0,c||rt(i,2,this.length),this[i]|this[i+1]<<8},u.prototype.readUInt16BE=function(i,c){return i>>>=0,c||rt(i,2,this.length),this[i]<<8|this[i+1]},u.prototype.readUInt32LE=function(i,c){return i>>>=0,c||rt(i,4,this.length),(this[i]|this[i+1]<<8|this[i+2]<<16)+16777216*this[i+3]},u.prototype.readUInt32BE=function(i,c){return i>>>=0,c||rt(i,4,this.length),16777216*this[i]+(this[i+1]<<16|this[i+2]<<8|this[i+3])},u.prototype.readIntLE=function(i,c,f){i>>>=0,c>>>=0,f||rt(i,c,this.length);for(var C=this[i],A=1,N=0;++N<c&&(A*=256);)C+=this[i+N]*A;return A*=128,C>=A&&(C-=s(2,8*c)),C},u.prototype.readIntBE=function(i,c,f){i>>>=0,c>>>=0,f||rt(i,c,this.length);for(var C=c,A=1,N=this[i+--C];0<C&&(A*=256);)N+=this[i+--C]*A;return A*=128,N>=A&&(N-=s(2,8*c)),N},u.prototype.readInt8=function(i,c){return i>>>=0,c||rt(i,1,this.length),128&this[i]?-1*(255-this[i]+1):this[i]},u.prototype.readInt16LE=function(i,c){i>>>=0,c||rt(i,2,this.length);var f=this[i]|this[i+1]<<8;return 32768&f?4294901760|f:f},u.prototype.readInt16BE=function(i,c){i>>>=0,c||rt(i,2,this.length);var f=this[i+1]|this[i]<<8;return 32768&f?4294901760|f:f},u.prototype.readInt32LE=function(i,c){return i>>>=0,c||rt(i,4,this.length),this[i]|this[i+1]<<8|this[i+2]<<16|this[i+3]<<24},u.prototype.readInt32BE=function(i,c){return i>>>=0,c||rt(i,4,this.length),this[i]<<24|this[i+1]<<16|this[i+2]<<8|this[i+3]},u.prototype.readFloatLE=function(i,c){return i>>>=0,c||rt(i,4,this.length),V.read(this,i,!0,23,4)},u.prototype.readFloatBE=function(i,c){return i>>>=0,c||rt(i,4,this.length),V.read(this,i,!1,23,4)},u.prototype.readDoubleLE=function(i,c){return i>>>=0,c||rt(i,8,this.length),V.read(this,i,!0,52,8)},u.prototype.readDoubleBE=function(i,c){return i>>>=0,c||rt(i,8,this.length),V.read(this,i,!1,52,8)},u.prototype.writeUIntLE=function(i,c,f,C){if(i=+i,c>>>=0,f>>>=0,!C){var A=s(2,8*f)-1;Q(this,i,c,f,A,0)}var N=1,j=0;for(this[c]=255&i;++j<f&&(N*=256);)this[c+j]=255&i/N;return c+f},u.prototype.writeUIntBE=function(i,c,f,C){if(i=+i,c>>>=0,f>>>=0,!C){var A=s(2,8*f)-1;Q(this,i,c,f,A,0)}var N=f-1,j=1;for(this[c+N]=255&i;0<=--N&&(j*=256);)this[c+N]=255&i/j;return c+f},u.prototype.writeUInt8=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,1,255,0),this[c]=255&i,c+1},u.prototype.writeUInt16LE=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,2,65535,0),this[c]=255&i,this[c+1]=i>>>8,c+2},u.prototype.writeUInt16BE=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,2,65535,0),this[c]=i>>>8,this[c+1]=255&i,c+2},u.prototype.writeUInt32LE=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,4,4294967295,0),this[c+3]=i>>>24,this[c+2]=i>>>16,this[c+1]=i>>>8,this[c]=255&i,c+4},u.prototype.writeUInt32BE=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,4,4294967295,0),this[c]=i>>>24,this[c+1]=i>>>16,this[c+2]=i>>>8,this[c+3]=255&i,c+4},u.prototype.writeIntLE=function(i,c,f,C){if(i=+i,c>>>=0,!C){var A=s(2,8*f-1);Q(this,i,c,f,A-1,-A)}var N=0,j=1,G=0;for(this[c]=255&i;++N<f&&(j*=256);)0>i&&G===0&&this[c+N-1]!==0&&(G=1),this[c+N]=255&(i/j>>0)-G;return c+f},u.prototype.writeIntBE=function(i,c,f,C){if(i=+i,c>>>=0,!C){var A=s(2,8*f-1);Q(this,i,c,f,A-1,-A)}var N=f-1,j=1,G=0;for(this[c+N]=255&i;0<=--N&&(j*=256);)0>i&&G===0&&this[c+N+1]!==0&&(G=1),this[c+N]=255&(i/j>>0)-G;return c+f},u.prototype.writeInt8=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,1,127,-128),0>i&&(i=255+i+1),this[c]=255&i,c+1},u.prototype.writeInt16LE=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,2,32767,-32768),this[c]=255&i,this[c+1]=i>>>8,c+2},u.prototype.writeInt16BE=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,2,32767,-32768),this[c]=i>>>8,this[c+1]=255&i,c+2},u.prototype.writeInt32LE=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,4,2147483647,-2147483648),this[c]=255&i,this[c+1]=i>>>8,this[c+2]=i>>>16,this[c+3]=i>>>24,c+4},u.prototype.writeInt32BE=function(i,c,f){return i=+i,c>>>=0,f||Q(this,i,c,4,2147483647,-2147483648),0>i&&(i=4294967295+i+1),this[c]=i>>>24,this[c+1]=i>>>16,this[c+2]=i>>>8,this[c+3]=255&i,c+4},u.prototype.writeFloatLE=function(i,c,f){return Xt(this,i,c,!0,f)},u.prototype.writeFloatBE=function(i,c,f){return Xt(this,i,c,!1,f)},u.prototype.writeDoubleLE=function(i,c,f){return Zt(this,i,c,!0,f)},u.prototype.writeDoubleBE=function(i,c,f){return Zt(this,i,c,!1,f)},u.prototype.copy=function(i,c,f,C){if(!u.isBuffer(i))throw new TypeError("argument should be a Buffer");if(f||(f=0),C||C===0||(C=this.length),c>=i.length&&(c=i.length),c||(c=0),0<C&&C<f&&(C=f),C===f||i.length===0||this.length===0)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>f||f>=this.length)throw new RangeError("Index out of range");if(0>C)throw new RangeError("sourceEnd out of bounds");C>this.length&&(C=this.length),i.length-c<C-f&&(C=i.length-c+f);var A=C-f;if(this===i&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(c,f,C);else if(this===i&&f<c&&c<C)for(var N=A-1;0<=N;--N)i[N+c]=this[N+f];else Uint8Array.prototype.set.call(i,this.subarray(f,C),c);return A},u.prototype.fill=function(i,c,f,C){if(typeof i=="string"){if(typeof c=="string"?(C=c,c=0,f=this.length):typeof f=="string"&&(C=f,f=this.length),C!==void 0&&typeof C!="string")throw new TypeError("encoding must be a string");if(typeof C=="string"&&!u.isEncoding(C))throw new TypeError("Unknown encoding: "+C);if(i.length===1){var A=i.charCodeAt(0);(C==="utf8"&&128>A||C==="latin1")&&(i=A)}}else typeof i=="number"&&(i&=255);if(0>c||this.length<c||this.length<f)throw new RangeError("Out of range index");if(f<=c)return this;c>>>=0,f=f===void 0?this.length:f>>>0,i||(i=0);var N;if(typeof i=="number")for(N=c;N<f;++N)this[N]=i;else{var j=u.isBuffer(i)?i:u.from(i,C),G=j.length;if(G===0)throw new TypeError('The value "'+i+'" is invalid for argument "value"');for(N=0;N<f-c;++N)this[N+c]=j[N%G]}return this};var _=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,o("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(o,a,l){(function(h){(function(){function p(){let u;try{u=l.storage.getItem("debug")}catch{}return!u&&typeof h<"u"&&"env"in h&&(u=h.env.DEBUG),u}l.formatArgs=function(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+a.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;u.splice(1,0,d,"color: inherit");let w=0,g=0;u[0].replace(/%[a-zA-Z%]/g,E=>{E==="%%"||(w++,E==="%c"&&(g=w))}),u.splice(g,0,d)},l.save=function(u){try{u?l.storage.setItem("debug",u):l.storage.removeItem("debug")}catch{}},l.load=p,l.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},l.storage=function(){try{return localStorage}catch{}}(),l.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),l.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],l.log=console.debug||console.log||(()=>{}),a.exports=o("./common")(l);const{formatters:m}=a.exports;m.j=function(u){try{return JSON.stringify(u)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}}).call(this)}).call(this,o("_process"))},{"./common":5,_process:12}],5:[function(o,a){a.exports=function(l){function h(u){function d(...E){if(!d.enabled)return;const x=d,O=+new Date,M=O-(w||O);x.diff=M,x.prev=w,x.curr=O,w=O,E[0]=h.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let y=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(v,R)=>{if(v==="%%")return"%";y++;const S=h.formatters[R];if(typeof S=="function"){const I=E[y];v=S.call(x,I),E.splice(y,1),y--}return v}),h.formatArgs.call(x,E),(x.log||h.log).apply(x,E)}let w,g=null;return d.namespace=u,d.useColors=h.useColors(),d.color=h.selectColor(u),d.extend=p,d.destroy=h.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>g===null?h.enabled(u):g,set:E=>{g=E}}),typeof h.init=="function"&&h.init(d),d}function p(u,d){const w=h(this.namespace+(typeof d>"u"?":":d)+u);return w.log=this.log,w}function m(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}return h.debug=h,h.default=h,h.coerce=function(u){return u instanceof Error?u.stack||u.message:u},h.disable=function(){const u=[...h.names.map(m),...h.skips.map(m).map(d=>"-"+d)].join(",");return h.enable(""),u},h.enable=function(u){h.save(u),h.names=[],h.skips=[];let d;const w=(typeof u=="string"?u:"").split(/[\s,]+/),g=w.length;for(d=0;d<g;d++)w[d]&&(u=w[d].replace(/\*/g,".*?"),u[0]==="-"?h.skips.push(new RegExp("^"+u.substr(1)+"$")):h.names.push(new RegExp("^"+u+"$")))},h.enabled=function(u){if(u[u.length-1]==="*")return!0;let d,w;for(d=0,w=h.skips.length;d<w;d++)if(h.skips[d].test(u))return!1;for(d=0,w=h.names.length;d<w;d++)if(h.names[d].test(u))return!0;return!1},h.humanize=o("ms"),h.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(l).forEach(u=>{h[u]=l[u]}),h.names=[],h.skips=[],h.formatters={},h.selectColor=function(u){let d=0;for(let w=0;w<u.length;w++)d=(d<<5)-d+u.charCodeAt(w),d|=0;return h.colors[r(d)%h.colors.length]},h.enable(h.load()),h}},{ms:11}],6:[function(o,a){function l(h,p){for(const m in p)Object.defineProperty(h,m,{value:p[m],enumerable:!0,configurable:!0});return h}a.exports=function(h,p,m){if(!h||typeof h=="string")throw new TypeError("Please pass an Error to err-code");m||(m={}),typeof p=="object"&&(m=p,p=""),p&&(m.code=p);try{return l(h,m)}catch{m.message=h.message,m.stack=h.stack;const d=function(){};return d.prototype=Object.create(Object.getPrototypeOf(h)),l(new d,m)}}},{}],7:[function(o,a){function l(k){console&&console.warn&&console.warn(k)}function h(){h.init.call(this)}function p(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}function m(k){return k._maxListeners===void 0?h.defaultMaxListeners:k._maxListeners}function u(k,T,F,B){var z,Y,Z;if(p(F),Y=k._events,Y===void 0?(Y=k._events=Object.create(null),k._eventsCount=0):(Y.newListener!==void 0&&(k.emit("newListener",T,F.listener?F.listener:F),Y=k._events),Z=Y[T]),Z===void 0)Z=Y[T]=F,++k._eventsCount;else if(typeof Z=="function"?Z=Y[T]=B?[F,Z]:[Z,F]:B?Z.unshift(F):Z.push(F),z=m(k),0<z&&Z.length>z&&!Z.warned){Z.warned=!0;var st=new Error("Possible EventEmitter memory leak detected. "+Z.length+" "+(T+" listeners added. Use emitter.setMaxListeners() to increase limit"));st.name="MaxListenersExceededWarning",st.emitter=k,st.type=T,st.count=Z.length,l(st)}return k}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w(k,T,F){var B={fired:!1,wrapFn:void 0,target:k,type:T,listener:F},z=d.bind(B);return z.listener=F,B.wrapFn=z,z}function g(k,T,F){var B=k._events;if(B===void 0)return[];var z=B[T];return z===void 0?[]:typeof z=="function"?F?[z.listener||z]:[z]:F?M(z):x(z,z.length)}function E(k){var T=this._events;if(T!==void 0){var F=T[k];if(typeof F=="function")return 1;if(F!==void 0)return F.length}return 0}function x(k,T){for(var F=Array(T),B=0;B<T;++B)F[B]=k[B];return F}function O(k,T){for(;T+1<k.length;T++)k[T]=k[T+1];k.pop()}function M(k){for(var T=Array(k.length),F=0;F<T.length;++F)T[F]=k[F].listener||k[F];return T}function y(k,T,F){typeof k.on=="function"&&b(k,"error",T,F)}function b(k,T,F,B){if(typeof k.on=="function")B.once?k.once(T,F):k.on(T,F);else if(typeof k.addEventListener=="function")k.addEventListener(T,function z(Y){B.once&&k.removeEventListener(T,z),F(Y)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}var v,R=typeof Reflect=="object"?Reflect:null,S=R&&typeof R.apply=="function"?R.apply:function(k,T,F){return Function.prototype.apply.call(k,T,F)};v=R&&typeof R.ownKeys=="function"?R.ownKeys:Object.getOwnPropertySymbols?function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:function(k){return Object.getOwnPropertyNames(k)};var I=Number.isNaN||function(k){return k!==k};a.exports=h,a.exports.once=function(k,T){return new Promise(function(F,B){function z(Z){k.removeListener(T,Y),B(Z)}function Y(){typeof k.removeListener=="function"&&k.removeListener("error",z),F([].slice.call(arguments))}b(k,T,Y,{once:!0}),T!=="error"&&y(k,z,{once:!0})})},h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var U=10;Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return U},set:function(k){if(typeof k!="number"||0>k||I(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");U=k}}),h.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=function(k){if(typeof k!="number"||0>k||I(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this},h.prototype.getMaxListeners=function(){return m(this)},h.prototype.emit=function(k){for(var T=[],F=1;F<arguments.length;F++)T.push(arguments[F]);var B=k==="error",z=this._events;if(z!==void 0)B=B&&z.error===void 0;else if(!B)return!1;if(B){var Y;if(0<T.length&&(Y=T[0]),Y instanceof Error)throw Y;var Z=new Error("Unhandled error."+(Y?" ("+Y.message+")":""));throw Z.context=Y,Z}var st=z[k];if(st===void 0)return!1;if(typeof st=="function")S(st,this,T);else for(var pt=st.length,q=x(st,pt),F=0;F<pt;++F)S(q[F],this,T);return!0},h.prototype.addListener=function(k,T){return u(this,k,T,!1)},h.prototype.on=h.prototype.addListener,h.prototype.prependListener=function(k,T){return u(this,k,T,!0)},h.prototype.once=function(k,T){return p(T),this.on(k,w(this,k,T)),this},h.prototype.prependOnceListener=function(k,T){return p(T),this.prependListener(k,w(this,k,T)),this},h.prototype.removeListener=function(k,T){var F,B,z,Y,Z;if(p(T),B=this._events,B===void 0)return this;if(F=B[k],F===void 0)return this;if(F===T||F.listener===T)--this._eventsCount==0?this._events=Object.create(null):(delete B[k],B.removeListener&&this.emit("removeListener",k,F.listener||T));else if(typeof F!="function"){for(z=-1,Y=F.length-1;0<=Y;Y--)if(F[Y]===T||F[Y].listener===T){Z=F[Y].listener,z=Y;break}if(0>z)return this;z===0?F.shift():O(F,z),F.length===1&&(B[k]=F[0]),B.removeListener!==void 0&&this.emit("removeListener",k,Z||T)}return this},h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=function(k){var T,F,B;if(F=this._events,F===void 0)return this;if(F.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):F[k]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete F[k]),this;if(arguments.length===0){var z,Y=Object.keys(F);for(B=0;B<Y.length;++B)z=Y[B],z!=="removeListener"&&this.removeAllListeners(z);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(T=F[k],typeof T=="function")this.removeListener(k,T);else if(T!==void 0)for(B=T.length-1;0<=B;B--)this.removeListener(k,T[B]);return this},h.prototype.listeners=function(k){return g(this,k,!0)},h.prototype.rawListeners=function(k){return g(this,k,!1)},h.listenerCount=function(k,T){return typeof k.listenerCount=="function"?k.listenerCount(T):E.call(k,T)},h.prototype.listenerCount=E,h.prototype.eventNames=function(){return 0<this._eventsCount?v(this._events):[]}},{}],8:[function(o,a){a.exports=function(){if(typeof globalThis>"u")return null;var l={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return l.RTCPeerConnection?l:null}},{}],9:[function(o,a,l){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */l.read=function(h,p,m,u,d){var w,g,E=8*d-u-1,x=(1<<E)-1,O=x>>1,M=-7,y=m?d-1:0,b=m?-1:1,v=h[p+y];for(y+=b,w=v&(1<<-M)-1,v>>=-M,M+=E;0<M;w=256*w+h[p+y],y+=b,M-=8);for(g=w&(1<<-M)-1,w>>=-M,M+=u;0<M;g=256*g+h[p+y],y+=b,M-=8);if(w===0)w=1-O;else{if(w===x)return g?NaN:(v?-1:1)*(1/0);g+=s(2,u),w-=O}return(v?-1:1)*g*s(2,w-u)},l.write=function(h,p,m,u,d,w){var g,E,x,O=Math.LN2,M=Math.log,y=8*w-d-1,b=(1<<y)-1,v=b>>1,R=d===23?s(2,-24)-s(2,-77):0,S=u?0:w-1,I=u?1:-1,U=0>p||p===0&&0>1/p?1:0;for(p=r(p),isNaN(p)||p===1/0?(E=isNaN(p)?1:0,g=b):(g=n(M(p)/O),1>p*(x=s(2,-g))&&(g--,x*=2),p+=1<=g+v?R/x:R*s(2,1-v),2<=p*x&&(g++,x/=2),g+v>=b?(E=0,g=b):1<=g+v?(E=(p*x-1)*s(2,d),g+=v):(E=p*s(2,v-1)*s(2,d),g=0));8<=d;h[m+S]=255&E,S+=I,E/=256,d-=8);for(g=g<<d|E,y+=d;0<y;h[m+S]=255&g,S+=I,g/=256,y-=8);h[m+S-I]|=128*U}},{}],10:[function(o,a){a.exports=typeof Object.create=="function"?function(l,h){h&&(l.super_=h,l.prototype=Object.create(h.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}))}:function(l,h){if(h){l.super_=h;var p=function(){};p.prototype=h.prototype,l.prototype=new p,l.prototype.constructor=l}}},{}],11:[function(o,a){var l=Math.round;function h(d){if(d+="",!(100<d.length)){var w=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(w){var g=parseFloat(w[1]),E=(w[2]||"ms").toLowerCase();return E==="years"||E==="year"||E==="yrs"||E==="yr"||E==="y"?315576e5*g:E==="weeks"||E==="week"||E==="w"?6048e5*g:E==="days"||E==="day"||E==="d"?864e5*g:E==="hours"||E==="hour"||E==="hrs"||E==="hr"||E==="h"?36e5*g:E==="minutes"||E==="minute"||E==="mins"||E==="min"||E==="m"?6e4*g:E==="seconds"||E==="second"||E==="secs"||E==="sec"||E==="s"?1e3*g:E==="milliseconds"||E==="millisecond"||E==="msecs"||E==="msec"||E==="ms"?g:void 0}}}function p(d){var w=r(d);return 864e5<=w?l(d/864e5)+"d":36e5<=w?l(d/36e5)+"h":6e4<=w?l(d/6e4)+"m":1e3<=w?l(d/1e3)+"s":d+"ms"}function m(d){var w=r(d);return 864e5<=w?u(d,w,864e5,"day"):36e5<=w?u(d,w,36e5,"hour"):6e4<=w?u(d,w,6e4,"minute"):1e3<=w?u(d,w,1e3,"second"):d+" ms"}function u(d,w,g,E){return l(d/g)+" "+E+(w>=1.5*g?"s":"")}a.exports=function(d,w){w=w||{};var g=typeof d;if(g=="string"&&0<d.length)return h(d);if(g==="number"&&isFinite(d))return w.long?m(d):p(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},{}],12:[function(o,a){function l(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function p(R){if(E===setTimeout)return setTimeout(R,0);if((E===l||!E)&&setTimeout)return E=setTimeout,setTimeout(R,0);try{return E(R,0)}catch{try{return E.call(null,R,0)}catch{return E.call(this,R,0)}}}function m(R){if(x===clearTimeout)return clearTimeout(R);if((x===h||!x)&&clearTimeout)return x=clearTimeout,clearTimeout(R);try{return x(R)}catch{try{return x.call(null,R)}catch{return x.call(this,R)}}}function u(){b&&M&&(b=!1,M.length?y=M.concat(y):v=-1,y.length&&d())}function d(){if(!b){var R=p(u);b=!0;for(var S=y.length;S;){for(M=y,y=[];++v<S;)M&&M[v].run();v=-1,S=y.length}M=null,b=!1,m(R)}}function w(R,S){this.fun=R,this.array=S}function g(){}var E,x,O=a.exports={};(function(){try{E=typeof setTimeout=="function"?setTimeout:l}catch{E=l}try{x=typeof clearTimeout=="function"?clearTimeout:h}catch{x=h}})();var M,y=[],b=!1,v=-1;O.nextTick=function(R){var S=Array(arguments.length-1);if(1<arguments.length)for(var I=1;I<arguments.length;I++)S[I-1]=arguments[I];y.push(new w(R,S)),y.length!==1||b||p(d)},w.prototype.run=function(){this.fun.apply(null,this.array)},O.title="browser",O.browser=!0,O.env={},O.argv=[],O.version="",O.versions={},O.on=g,O.addListener=g,O.once=g,O.off=g,O.removeListener=g,O.removeAllListeners=g,O.emit=g,O.prependListener=g,O.prependOnceListener=g,O.listeners=function(){return[]},O.binding=function(){throw new Error("process.binding is not supported")},O.cwd=function(){return"/"},O.chdir=function(){throw new Error("process.chdir is not supported")},O.umask=function(){return 0}},{}],13:[function(o,a){(function(l){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let h;a.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?l:window):p=>(h||(h=Promise.resolve())).then(p).catch(m=>setTimeout(()=>{throw m},0))}).call(this)}).call(this,typeof Nt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nt)},{}],14:[function(o,a){(function(l,h){(function(){var p=o("safe-buffer").Buffer,m=h.crypto||h.msCrypto;a.exports=m&&m.getRandomValues?function(u,d){if(u>4294967295)throw new RangeError("requested too many random bytes");var w=p.allocUnsafe(u);if(0<u)if(65536<u)for(var g=0;g<u;g+=65536)m.getRandomValues(w.slice(g,g+65536));else m.getRandomValues(w);return typeof d=="function"?l.nextTick(function(){d(null,w)}):w}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,o("_process"),typeof Nt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nt)},{_process:12,"safe-buffer":30}],15:[function(o,a){function l(g,E){g.prototype=Object.create(E.prototype),g.prototype.constructor=g,g.__proto__=E}function h(g,E,x){function O(y,b,v){return typeof E=="string"?E:E(y,b,v)}x||(x=Error);var M=function(y){function b(v,R,S){return y.call(this,O(v,R,S))||this}return l(b,y),b}(x);M.prototype.name=x.name,M.prototype.code=g,w[g]=M}function p(g,E){if(Array.isArray(g)){var x=g.length;return g=g.map(function(O){return O+""}),2<x?"one of ".concat(E," ").concat(g.slice(0,x-1).join(", "),", or ")+g[x-1]:x===2?"one of ".concat(E," ").concat(g[0]," or ").concat(g[1]):"of ".concat(E," ").concat(g[0])}return"of ".concat(E," ").concat(g+"")}function m(g,E,x){return g.substr(!x||0>x?0:+x,E.length)===E}function u(g,E,x){return(x===void 0||x>g.length)&&(x=g.length),g.substring(x-E.length,x)===E}function d(g,E,x){return typeof x!="number"&&(x=0),!(x+E.length>g.length)&&g.indexOf(E,x)!==-1}var w={};h("ERR_INVALID_OPT_VALUE",function(g,E){return'The value "'+E+'" is invalid for option "'+g+'"'},TypeError),h("ERR_INVALID_ARG_TYPE",function(g,E,x){var O;typeof E=="string"&&m(E,"not ")?(O="must not be",E=E.replace(/^not /,"")):O="must be";var M;if(u(g," argument"))M="The ".concat(g," ").concat(O," ").concat(p(E,"type"));else{var y=d(g,".")?"property":"argument";M='The "'.concat(g,'" ').concat(y," ").concat(O," ").concat(p(E,"type"))}return M+=". Received type ".concat(typeof x),M},TypeError),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),h("ERR_METHOD_NOT_IMPLEMENTED",function(g){return"The "+g+" method is not implemented"}),h("ERR_STREAM_PREMATURE_CLOSE","Premature close"),h("ERR_STREAM_DESTROYED",function(g){return"Cannot call "+g+" after a stream was destroyed"}),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),h("ERR_STREAM_WRITE_AFTER_END","write after end"),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_UNKNOWN_ENCODING",function(g){return"Unknown encoding: "+g},TypeError),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.codes=w},{}],16:[function(o,a){(function(l){(function(){function h(O){return this instanceof h?(d.call(this,O),w.call(this,O),this.allowHalfOpen=!0,void(O&&(O.readable===!1&&(this.readable=!1),O.writable===!1&&(this.writable=!1),O.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",p))))):new h(O)}function p(){this._writableState.ended||l.nextTick(m,this)}function m(O){O.end()}var u=Object.keys||function(O){var M=[];for(var y in O)M.push(y);return M};a.exports=h;var d=o("./_stream_readable"),w=o("./_stream_writable");o("inherits")(h,d);for(var g,E=u(w.prototype),x=0;x<E.length;x++)g=E[x],h.prototype[g]||(h.prototype[g]=w.prototype[g]);Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(O){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=O,this._writableState.destroyed=O)}})}).call(this)}).call(this,o("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(o,a){function l(p){return this instanceof l?void h.call(this,p):new l(p)}a.exports=l;var h=o("./_stream_transform");o("inherits")(l,h),l.prototype._transform=function(p,m,u){u(null,p)}},{"./_stream_transform":19,inherits:10}],18:[function(o,a){(function(l,h){(function(){function p(_){return Kt.from(_)}function m(_){return Kt.isBuffer(_)||_ instanceof rt}function u(_,i,c){return typeof _.prependListener=="function"?_.prependListener(i,c):void(_._events&&_._events[i]?Array.isArray(_._events[i])?_._events[i].unshift(c):_._events[i]=[c,_._events[i]]:_.on(i,c))}function d(_,i,c){pt=pt||o("./_stream_duplex"),_=_||{},typeof c!="boolean"&&(c=i instanceof pt),this.objectMode=!!_.objectMode,c&&(this.objectMode=this.objectMode||!!_.readableObjectMode),this.highWaterMark=Pe(this,_,"readableHighWaterMark",c),this.buffer=new Fe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=_.emitClose!==!1,this.autoDestroy=!!_.autoDestroy,this.destroyed=!1,this.defaultEncoding=_.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,_.encoding&&(!kt&&(kt=o("string_decoder/").StringDecoder),this.decoder=new kt(_.encoding),this.encoding=_.encoding)}function w(_){if(pt=pt||o("./_stream_duplex"),!(this instanceof w))return new w(_);var i=this instanceof pt;this._readableState=new d(_,this,i),this.readable=!0,_&&(typeof _.read=="function"&&(this._read=_.read),typeof _.destroy=="function"&&(this._destroy=_.destroy)),Ct.call(this)}function g(_,i,c,f,C){q("readableAddChunk",i);var A=_._readableState;if(i===null)A.reading=!1,y(_,A);else{var N;if(C||(N=x(A,i)),N)P(_,N);else if(!(A.objectMode||i&&0<i.length))f||(A.reading=!1,R(_,A));else if(typeof i=="string"||A.objectMode||Object.getPrototypeOf(i)===Kt.prototype||(i=p(i)),f)A.endEmitted?P(_,new L):E(_,A,i,!0);else if(A.ended)P(_,new At);else{if(A.destroyed)return!1;A.reading=!1,A.decoder&&!c?(i=A.decoder.write(i),A.objectMode||i.length!==0?E(_,A,i,!1):R(_,A)):E(_,A,i,!1)}}return!A.ended&&(A.length<A.highWaterMark||A.length===0)}function E(_,i,c,f){i.flowing&&i.length===0&&!i.sync?(i.awaitDrain=0,_.emit("data",c)):(i.length+=i.objectMode?1:c.length,f?i.buffer.unshift(c):i.buffer.push(c),i.needReadable&&b(_)),R(_,i)}function x(_,i){var c;return m(i)||typeof i=="string"||i===void 0||_.objectMode||(c=new Rt("chunk",["string","Buffer","Uint8Array"],i)),c}function O(_){return 1073741824<=_?_=1073741824:(_--,_|=_>>>1,_|=_>>>2,_|=_>>>4,_|=_>>>8,_|=_>>>16,_++),_}function M(_,i){return 0>=_||i.length===0&&i.ended?0:i.objectMode?1:_===_?(_>i.highWaterMark&&(i.highWaterMark=O(_)),_<=i.length?_:i.ended?i.length:(i.needReadable=!0,0)):i.flowing&&i.length?i.buffer.head.data.length:i.length}function y(_,i){if(q("onEofChunk"),!i.ended){if(i.decoder){var c=i.decoder.end();c&&c.length&&(i.buffer.push(c),i.length+=i.objectMode?1:c.length)}i.ended=!0,i.sync?b(_):(i.needReadable=!1,!i.emittedReadable&&(i.emittedReadable=!0,v(_)))}}function b(_){var i=_._readableState;q("emitReadable",i.needReadable,i.emittedReadable),i.needReadable=!1,i.emittedReadable||(q("emitReadable",i.flowing),i.emittedReadable=!0,l.nextTick(v,_))}function v(_){var i=_._readableState;q("emitReadable_",i.destroyed,i.length,i.ended),!i.destroyed&&(i.length||i.ended)&&(_.emit("readable"),i.emittedReadable=!1),i.needReadable=!i.flowing&&!i.ended&&i.length<=i.highWaterMark,B(_)}function R(_,i){i.readingMore||(i.readingMore=!0,l.nextTick(S,_,i))}function S(_,i){for(;!i.reading&&!i.ended&&(i.length<i.highWaterMark||i.flowing&&i.length===0);){var c=i.length;if(q("maybeReadMore read 0"),_.read(0),c===i.length)break}i.readingMore=!1}function I(_){return function(){var i=_._readableState;q("pipeOnDrain",i.awaitDrain),i.awaitDrain&&i.awaitDrain--,i.awaitDrain===0&&ve(_,"data")&&(i.flowing=!0,B(_))}}function U(_){var i=_._readableState;i.readableListening=0<_.listenerCount("readable"),i.resumeScheduled&&!i.paused?i.flowing=!0:0<_.listenerCount("data")&&_.resume()}function k(_){q("readable nexttick read 0"),_.read(0)}function T(_,i){i.resumeScheduled||(i.resumeScheduled=!0,l.nextTick(F,_,i))}function F(_,i){q("resume",i.reading),i.reading||_.read(0),i.resumeScheduled=!1,_.emit("resume"),B(_),i.flowing&&!i.reading&&_.read(0)}function B(_){var i=_._readableState;for(q("flow",i.flowing);i.flowing&&_.read()!==null;);}function z(_,i){if(i.length===0)return null;var c;return i.objectMode?c=i.buffer.shift():!_||_>=i.length?(c=i.decoder?i.buffer.join(""):i.buffer.length===1?i.buffer.first():i.buffer.concat(i.length),i.buffer.clear()):c=i.buffer.consume(_,i.decoder),c}function Y(_){var i=_._readableState;q("endReadable",i.endEmitted),i.endEmitted||(i.ended=!0,l.nextTick(Z,i,_))}function Z(_,i){if(q("endReadableNT",_.endEmitted,_.length),!_.endEmitted&&_.length===0&&(_.endEmitted=!0,i.readable=!1,i.emit("end"),_.autoDestroy)){var c=i._writableState;(!c||c.autoDestroy&&c.finished)&&i.destroy()}}function st(_,i){for(var c=0,f=_.length;c<f;c++)if(_[c]===i)return c;return-1}a.exports=w;var pt;w.ReadableState=d;var q;o("events").EventEmitter;var ve=function(_,i){return _.listeners(i).length},Ct=o("./internal/streams/stream"),Kt=o("buffer").Buffer,rt=h.Uint8Array||function(){},Q=o("util");q=Q&&Q.debuglog?Q.debuglog("stream"):function(){};var kt,Xt,Zt,Fe=o("./internal/streams/buffer_list"),se=o("./internal/streams/destroy"),oe=o("./internal/streams/state"),Pe=oe.getHighWaterMark,Qt=o("../errors").codes,Rt=Qt.ERR_INVALID_ARG_TYPE,At=Qt.ERR_STREAM_PUSH_AFTER_EOF,D=Qt.ERR_METHOD_NOT_IMPLEMENTED,L=Qt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;o("inherits")(w,Ct);var P=se.errorOrDestroy,V=["error","close","destroy","pause","resume"];Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(_){this._readableState&&(this._readableState.destroyed=_)}}),w.prototype.destroy=se.destroy,w.prototype._undestroy=se.undestroy,w.prototype._destroy=function(_,i){i(_)},w.prototype.push=function(_,i){var c,f=this._readableState;return f.objectMode?c=!0:typeof _=="string"&&(i=i||f.defaultEncoding,i!==f.encoding&&(_=Kt.from(_,i),i=""),c=!0),g(this,_,i,!1,c)},w.prototype.unshift=function(_){return g(this,_,null,!0,!1)},w.prototype.isPaused=function(){return this._readableState.flowing===!1},w.prototype.setEncoding=function(_){kt||(kt=o("string_decoder/").StringDecoder);var i=new kt(_);this._readableState.decoder=i,this._readableState.encoding=this._readableState.decoder.encoding;for(var c=this._readableState.buffer.head,f="";c!==null;)f+=i.write(c.data),c=c.next;return this._readableState.buffer.clear(),f!==""&&this._readableState.buffer.push(f),this._readableState.length=f.length,this},w.prototype.read=function(_){q("read",_),_=parseInt(_,10);var i=this._readableState,c=_;if(_!==0&&(i.emittedReadable=!1),_===0&&i.needReadable&&((i.highWaterMark===0?0<i.length:i.length>=i.highWaterMark)||i.ended))return q("read: emitReadable",i.length,i.ended),i.length===0&&i.ended?Y(this):b(this),null;if(_=M(_,i),_===0&&i.ended)return i.length===0&&Y(this),null;var f=i.needReadable;q("need readable",f),(i.length===0||i.length-_<i.highWaterMark)&&(f=!0,q("length less than watermark",f)),i.ended||i.reading?(f=!1,q("reading or ended",f)):f&&(q("do read"),i.reading=!0,i.sync=!0,i.length===0&&(i.needReadable=!0),this._read(i.highWaterMark),i.sync=!1,!i.reading&&(_=M(c,i)));var C;return C=0<_?z(_,i):null,C===null?(i.needReadable=i.length<=i.highWaterMark,_=0):(i.length-=_,i.awaitDrain=0),i.length===0&&(!i.ended&&(i.needReadable=!0),c!==_&&i.ended&&Y(this)),C!==null&&this.emit("data",C),C},w.prototype._read=function(){P(this,new D("_read()"))},w.prototype.pipe=function(_,i){function c(Se,Ce){q("onunpipe"),Se===$&&Ce&&Ce.hasUnpiped===!1&&(Ce.hasUnpiped=!0,C())}function f(){q("onend"),_.end()}function C(){q("cleanup"),_.removeListener("close",j),_.removeListener("finish",G),_.removeListener("drain",Ee),_.removeListener("error",N),_.removeListener("unpipe",c),$.removeListener("end",f),$.removeListener("end",et),$.removeListener("data",A),Be=!0,J.awaitDrain&&(!_._writableState||_._writableState.needDrain)&&Ee()}function A(Se){q("ondata");var Ce=_.write(Se);q("dest.write",Ce),Ce===!1&&((J.pipesCount===1&&J.pipes===_||1<J.pipesCount&&st(J.pipes,_)!==-1)&&!Be&&(q("false write response, pause",J.awaitDrain),J.awaitDrain++),$.pause())}function N(Se){q("onerror",Se),et(),_.removeListener("error",N),ve(_,"error")===0&&P(_,Se)}function j(){_.removeListener("finish",G),et()}function G(){q("onfinish"),_.removeListener("close",j),et()}function et(){q("unpipe"),$.unpipe(_)}var $=this,J=this._readableState;switch(J.pipesCount){case 0:J.pipes=_;break;case 1:J.pipes=[J.pipes,_];break;default:J.pipes.push(_)}J.pipesCount+=1,q("pipe count=%d opts=%j",J.pipesCount,i);var ft=(!i||i.end!==!1)&&_!==l.stdout&&_!==l.stderr,ce=ft?f:et;J.endEmitted?l.nextTick(ce):$.once("end",ce),_.on("unpipe",c);var Ee=I($);_.on("drain",Ee);var Be=!1;return $.on("data",A),u(_,"error",N),_.once("close",j),_.once("finish",G),_.emit("pipe",$),J.flowing||(q("pipe resume"),$.resume()),_},w.prototype.unpipe=function(_){var i=this._readableState,c={hasUnpiped:!1};if(i.pipesCount===0)return this;if(i.pipesCount===1)return _&&_!==i.pipes?this:(_||(_=i.pipes),i.pipes=null,i.pipesCount=0,i.flowing=!1,_&&_.emit("unpipe",this,c),this);if(!_){var f=i.pipes,C=i.pipesCount;i.pipes=null,i.pipesCount=0,i.flowing=!1;for(var A=0;A<C;A++)f[A].emit("unpipe",this,{hasUnpiped:!1});return this}var N=st(i.pipes,_);return N===-1?this:(i.pipes.splice(N,1),i.pipesCount-=1,i.pipesCount===1&&(i.pipes=i.pipes[0]),_.emit("unpipe",this,c),this)},w.prototype.on=function(_,i){var c=Ct.prototype.on.call(this,_,i),f=this._readableState;return _==="data"?(f.readableListening=0<this.listenerCount("readable"),f.flowing!==!1&&this.resume()):_=="readable"&&!f.endEmitted&&!f.readableListening&&(f.readableListening=f.needReadable=!0,f.flowing=!1,f.emittedReadable=!1,q("on readable",f.length,f.reading),f.length?b(this):!f.reading&&l.nextTick(k,this)),c},w.prototype.addListener=w.prototype.on,w.prototype.removeListener=function(_,i){var c=Ct.prototype.removeListener.call(this,_,i);return _==="readable"&&l.nextTick(U,this),c},w.prototype.removeAllListeners=function(_){var i=Ct.prototype.removeAllListeners.apply(this,arguments);return(_==="readable"||_===void 0)&&l.nextTick(U,this),i},w.prototype.resume=function(){var _=this._readableState;return _.flowing||(q("resume"),_.flowing=!_.readableListening,T(this,_)),_.paused=!1,this},w.prototype.pause=function(){return q("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(q("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},w.prototype.wrap=function(_){var i=this,c=this._readableState,f=!1;for(var C in _.on("end",function(){if(q("wrapped end"),c.decoder&&!c.ended){var N=c.decoder.end();N&&N.length&&i.push(N)}i.push(null)}),_.on("data",function(N){if(q("wrapped data"),c.decoder&&(N=c.decoder.write(N)),!(c.objectMode&&N==null)&&(c.objectMode||N&&N.length)){var j=i.push(N);j||(f=!0,_.pause())}}),_)this[C]===void 0&&typeof _[C]=="function"&&(this[C]=function(N){return function(){return _[N].apply(_,arguments)}}(C));for(var A=0;A<V.length;A++)_.on(V[A],this.emit.bind(this,V[A]));return this._read=function(N){q("wrapped _read",N),f&&(f=!1,_.resume())},this},typeof Symbol=="function"&&(w.prototype[Symbol.asyncIterator]=function(){return Xt===void 0&&(Xt=o("./internal/streams/async_iterator")),Xt(this)}),Object.defineProperty(w.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(w.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(w.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(_){this._readableState&&(this._readableState.flowing=_)}}),w._fromList=z,Object.defineProperty(w.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(w.from=function(_,i){return Zt===void 0&&(Zt=o("./internal/streams/from")),Zt(w,_,i)})}).call(this)}).call(this,o("_process"),typeof Nt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(o,a){function l(O,M){var y=this._transformState;y.transforming=!1;var b=y.writecb;if(b===null)return this.emit("error",new w);y.writechunk=null,y.writecb=null,M!=null&&this.push(M),b(O);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function h(O){return this instanceof h?(x.call(this,O),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,O&&(typeof O.transform=="function"&&(this._transform=O.transform),typeof O.flush=="function"&&(this._flush=O.flush)),void this.on("prefinish",p)):new h(O)}function p(){var O=this;typeof this._flush!="function"||this._readableState.destroyed?m(this,null,null):this._flush(function(M,y){m(O,M,y)})}function m(O,M,y){if(M)return O.emit("error",M);if(y!=null&&O.push(y),O._writableState.length)throw new E;if(O._transformState.transforming)throw new g;return O.push(null)}a.exports=h;var u=o("../errors").codes,d=u.ERR_METHOD_NOT_IMPLEMENTED,w=u.ERR_MULTIPLE_CALLBACK,g=u.ERR_TRANSFORM_ALREADY_TRANSFORMING,E=u.ERR_TRANSFORM_WITH_LENGTH_0,x=o("./_stream_duplex");o("inherits")(h,x),h.prototype.push=function(O,M){return this._transformState.needTransform=!1,x.prototype.push.call(this,O,M)},h.prototype._transform=function(O,M,y){y(new d("_transform()"))},h.prototype._write=function(O,M,y){var b=this._transformState;if(b.writecb=y,b.writechunk=O,b.writeencoding=M,!b.transforming){var v=this._readableState;(b.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},h.prototype._read=function(){var O=this._transformState;O.writechunk===null||O.transforming?O.needTransform=!0:(O.transforming=!0,this._transform(O.writechunk,O.writeencoding,O.afterTransform))},h.prototype._destroy=function(O,M){x.prototype._destroy.call(this,O,function(y){M(y)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(o,a){(function(l,h){(function(){function p(D){var L=this;this.next=null,this.entry=null,this.finish=function(){Y(L,D)}}function m(D){return q.from(D)}function u(D){return q.isBuffer(D)||D instanceof ve}function d(){}function w(D,L,P){Z=Z||o("./_stream_duplex"),D=D||{},typeof P!="boolean"&&(P=L instanceof Z),this.objectMode=!!D.objectMode,P&&(this.objectMode=this.objectMode||!!D.writableObjectMode),this.highWaterMark=rt(this,D,"writableHighWaterMark",P),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var V=D.decodeStrings===!1;this.decodeStrings=!V,this.defaultEncoding=D.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(_){R(L,_)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new p(this)}function g(D){Z=Z||o("./_stream_duplex");var L=this instanceof Z;return L||At.call(g,this)?(this._writableState=new w(D,this,L),this.writable=!0,D&&(typeof D.write=="function"&&(this._write=D.write),typeof D.writev=="function"&&(this._writev=D.writev),typeof D.destroy=="function"&&(this._destroy=D.destroy),typeof D.final=="function"&&(this._final=D.final)),void pt.call(this)):new g(D)}function E(D,L){var P=new Pe;Rt(D,P),l.nextTick(L,P)}function x(D,L,P,V){var _;return P===null?_=new oe:typeof P!="string"&&!L.objectMode&&(_=new kt("chunk",["string","Buffer"],P)),!_||(Rt(D,_),l.nextTick(V,_),!1)}function O(D,L,P){return D.objectMode||D.decodeStrings===!1||typeof L!="string"||(L=q.from(L,P)),L}function M(D,L,P,V,_,i){if(!P){var c=O(L,V,_);V!==c&&(P=!0,_="buffer",V=c)}var f=L.objectMode?1:V.length;L.length+=f;var C=L.length<L.highWaterMark;if(C||(L.needDrain=!0),L.writing||L.corked){var A=L.lastBufferedRequest;L.lastBufferedRequest={chunk:V,encoding:_,isBuf:P,callback:i,next:null},A?A.next=L.lastBufferedRequest:L.bufferedRequest=L.lastBufferedRequest,L.bufferedRequestCount+=1}else y(D,L,!1,f,V,_,i);return C}function y(D,L,P,V,_,i,c){L.writelen=V,L.writecb=c,L.writing=!0,L.sync=!0,L.destroyed?L.onwrite(new se("write")):P?D._writev(_,L.onwrite):D._write(_,i,L.onwrite),L.sync=!1}function b(D,L,P,V,_){--L.pendingcb,P?(l.nextTick(_,V),l.nextTick(B,D,L),D._writableState.errorEmitted=!0,Rt(D,V)):(_(V),D._writableState.errorEmitted=!0,Rt(D,V),B(D,L))}function v(D){D.writing=!1,D.writecb=null,D.length-=D.writelen,D.writelen=0}function R(D,L){var P=D._writableState,V=P.sync,_=P.writecb;if(typeof _!="function")throw new Zt;if(v(P),L)b(D,P,V,L,_);else{var i=k(P)||D.destroyed;i||P.corked||P.bufferProcessing||!P.bufferedRequest||U(D,P),V?l.nextTick(S,D,P,i,_):S(D,P,i,_)}}function S(D,L,P,V){P||I(D,L),L.pendingcb--,V(),B(D,L)}function I(D,L){L.length===0&&L.needDrain&&(L.needDrain=!1,D.emit("drain"))}function U(D,L){L.bufferProcessing=!0;var P=L.bufferedRequest;if(D._writev&&P&&P.next){var V=L.bufferedRequestCount,_=Array(V),i=L.corkedRequestsFree;i.entry=P;for(var c=0,f=!0;P;)_[c]=P,P.isBuf||(f=!1),P=P.next,c+=1;_.allBuffers=f,y(D,L,!0,L.length,_,"",i.finish),L.pendingcb++,L.lastBufferedRequest=null,i.next?(L.corkedRequestsFree=i.next,i.next=null):L.corkedRequestsFree=new p(L),L.bufferedRequestCount=0}else{for(;P;){var C=P.chunk,A=P.encoding,N=P.callback,j=L.objectMode?1:C.length;if(y(D,L,!1,j,C,A,N),P=P.next,L.bufferedRequestCount--,L.writing)break}P===null&&(L.lastBufferedRequest=null)}L.bufferedRequest=P,L.bufferProcessing=!1}function k(D){return D.ending&&D.length===0&&D.bufferedRequest===null&&!D.finished&&!D.writing}function T(D,L){D._final(function(P){L.pendingcb--,P&&Rt(D,P),L.prefinished=!0,D.emit("prefinish"),B(D,L)})}function F(D,L){L.prefinished||L.finalCalled||(typeof D._final!="function"||L.destroyed?(L.prefinished=!0,D.emit("prefinish")):(L.pendingcb++,L.finalCalled=!0,l.nextTick(T,D,L)))}function B(D,L){var P=k(L);if(P&&(F(D,L),L.pendingcb===0&&(L.finished=!0,D.emit("finish"),L.autoDestroy))){var V=D._readableState;(!V||V.autoDestroy&&V.endEmitted)&&D.destroy()}return P}function z(D,L,P){L.ending=!0,B(D,L),P&&(L.finished?l.nextTick(P):D.once("finish",P)),L.ended=!0,D.writable=!1}function Y(D,L,P){var V=D.entry;for(D.entry=null;V;){var _=V.callback;L.pendingcb--,_(P),V=V.next}L.corkedRequestsFree.next=D}a.exports=g;var Z;g.WritableState=w;var st={deprecate:o("util-deprecate")},pt=o("./internal/streams/stream"),q=o("buffer").Buffer,ve=h.Uint8Array||function(){},Ct=o("./internal/streams/destroy"),Kt=o("./internal/streams/state"),rt=Kt.getHighWaterMark,Q=o("../errors").codes,kt=Q.ERR_INVALID_ARG_TYPE,Xt=Q.ERR_METHOD_NOT_IMPLEMENTED,Zt=Q.ERR_MULTIPLE_CALLBACK,Fe=Q.ERR_STREAM_CANNOT_PIPE,se=Q.ERR_STREAM_DESTROYED,oe=Q.ERR_STREAM_NULL_VALUES,Pe=Q.ERR_STREAM_WRITE_AFTER_END,Qt=Q.ERR_UNKNOWN_ENCODING,Rt=Ct.errorOrDestroy;o("inherits")(g,pt),w.prototype.getBuffer=function(){for(var D=this.bufferedRequest,L=[];D;)L.push(D),D=D.next;return L},function(){try{Object.defineProperty(w.prototype,"buffer",{get:st.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var At;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(At=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(D){return!!At.call(this,D)||this===g&&D&&D._writableState instanceof w}})):At=function(D){return D instanceof this},g.prototype.pipe=function(){Rt(this,new Fe)},g.prototype.write=function(D,L,P){var V=this._writableState,_=!1,i=!V.objectMode&&u(D);return i&&!q.isBuffer(D)&&(D=m(D)),typeof L=="function"&&(P=L,L=null),i?L="buffer":!L&&(L=V.defaultEncoding),typeof P!="function"&&(P=d),V.ending?E(this,P):(i||x(this,V,D,P))&&(V.pendingcb++,_=M(this,V,i,D,L,P)),_},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var D=this._writableState;D.corked&&(D.corked--,!D.writing&&!D.corked&&!D.bufferProcessing&&D.bufferedRequest&&U(this,D))},g.prototype.setDefaultEncoding=function(D){if(typeof D=="string"&&(D=D.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((D+"").toLowerCase())))throw new Qt(D);return this._writableState.defaultEncoding=D,this},Object.defineProperty(g.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(D,L,P){P(new Xt("_write()"))},g.prototype._writev=null,g.prototype.end=function(D,L,P){var V=this._writableState;return typeof D=="function"?(P=D,D=null,L=null):typeof L=="function"&&(P=L,L=null),D!=null&&this.write(D,L),V.corked&&(V.corked=1,this.uncork()),V.ending||z(this,V,P),this},Object.defineProperty(g.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(g.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(D){this._writableState&&(this._writableState.destroyed=D)}}),g.prototype.destroy=Ct.destroy,g.prototype._undestroy=Ct.undestroy,g.prototype._destroy=function(D,L){L(D)}}).call(this)}).call(this,o("_process"),typeof Nt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(o,a){(function(l){(function(){function h(I,U,k){return U in I?Object.defineProperty(I,U,{value:k,enumerable:!0,configurable:!0,writable:!0}):I[U]=k,I}function p(I,U){return{value:I,done:U}}function m(I){var U=I[E];if(U!==null){var k=I[v].read();k!==null&&(I[y]=null,I[E]=null,I[x]=null,U(p(k,!1)))}}function u(I){l.nextTick(m,I)}function d(I,U){return function(k,T){I.then(function(){return U[M]?void k(p(void 0,!0)):void U[b](k,T)},T)}}var w,g=o("./end-of-stream"),E=Symbol("lastResolve"),x=Symbol("lastReject"),O=Symbol("error"),M=Symbol("ended"),y=Symbol("lastPromise"),b=Symbol("handlePromise"),v=Symbol("stream"),R=Object.getPrototypeOf(function(){}),S=Object.setPrototypeOf((w={get stream(){return this[v]},next:function(){var I=this,U=this[O];if(U!==null)return Promise.reject(U);if(this[M])return Promise.resolve(p(void 0,!0));if(this[v].destroyed)return new Promise(function(B,z){l.nextTick(function(){I[O]?z(I[O]):B(p(void 0,!0))})});var k,T=this[y];if(T)k=new Promise(d(T,this));else{var F=this[v].read();if(F!==null)return Promise.resolve(p(F,!1));k=new Promise(this[b])}return this[y]=k,k}},h(w,Symbol.asyncIterator,function(){return this}),h(w,"return",function(){var I=this;return new Promise(function(U,k){I[v].destroy(null,function(T){return T?void k(T):void U(p(void 0,!0))})})}),w),R);a.exports=function(I){var U,k=Object.create(S,(U={},h(U,v,{value:I,writable:!0}),h(U,E,{value:null,writable:!0}),h(U,x,{value:null,writable:!0}),h(U,O,{value:null,writable:!0}),h(U,M,{value:I._readableState.endEmitted,writable:!0}),h(U,b,{value:function(T,F){var B=k[v].read();B?(k[y]=null,k[E]=null,k[x]=null,T(p(B,!1))):(k[E]=T,k[x]=F)},writable:!0}),U));return k[y]=null,g(I,function(T){if(T&&T.code!=="ERR_STREAM_PREMATURE_CLOSE"){var F=k[x];return F!==null&&(k[y]=null,k[E]=null,k[x]=null,F(T)),void(k[O]=T)}var B=k[E];B!==null&&(k[y]=null,k[E]=null,k[x]=null,B(p(void 0,!0))),k[M]=!0}),I.on("readable",u.bind(null,k)),k}}).call(this)}).call(this,o("_process"))},{"./end-of-stream":24,_process:12}],22:[function(o,a){function l(y,b){var v=Object.keys(y);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(y);b&&(R=R.filter(function(S){return Object.getOwnPropertyDescriptor(y,S).enumerable})),v.push.apply(v,R)}return v}function h(y){for(var b,v=1;v<arguments.length;v++)b=arguments[v]==null?{}:arguments[v],v%2?l(Object(b),!0).forEach(function(R){p(y,R,b[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(b)):l(Object(b)).forEach(function(R){Object.defineProperty(y,R,Object.getOwnPropertyDescriptor(b,R))});return y}function p(y,b,v){return b in y?Object.defineProperty(y,b,{value:v,enumerable:!0,configurable:!0,writable:!0}):y[b]=v,y}function m(y,b){if(!(y instanceof b))throw new TypeError("Cannot call a class as a function")}function u(y,b){for(var v,R=0;R<b.length;R++)v=b[R],v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(y,v.key,v)}function d(y,b,v){return b&&u(y.prototype,b),v&&u(y,v),y}function w(y,b,v){E.prototype.copy.call(y,b,v)}var g=o("buffer"),E=g.Buffer,x=o("util"),O=x.inspect,M=O&&O.custom||"inspect";a.exports=function(){function y(){m(this,y),this.head=null,this.tail=null,this.length=0}return d(y,[{key:"push",value:function(b){var v={data:b,next:null};0<this.length?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(b){var v={data:b,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var b=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,b}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(b){if(this.length===0)return"";for(var v=this.head,R=""+v.data;v=v.next;)R+=b+v.data;return R}},{key:"concat",value:function(b){if(this.length===0)return E.alloc(0);for(var v=E.allocUnsafe(b>>>0),R=this.head,S=0;R;)w(R.data,v,S),S+=R.data.length,R=R.next;return v}},{key:"consume",value:function(b,v){var R;return b<this.head.data.length?(R=this.head.data.slice(0,b),this.head.data=this.head.data.slice(b)):b===this.head.data.length?R=this.shift():R=v?this._getString(b):this._getBuffer(b),R}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(b){var v=this.head,R=1,S=v.data;for(b-=S.length;v=v.next;){var I=v.data,U=b>I.length?I.length:b;if(S+=U===I.length?I:I.slice(0,b),b-=U,b===0){U===I.length?(++R,this.head=v.next?v.next:this.tail=null):(this.head=v,v.data=I.slice(U));break}++R}return this.length-=R,S}},{key:"_getBuffer",value:function(b){var v=E.allocUnsafe(b),R=this.head,S=1;for(R.data.copy(v),b-=R.data.length;R=R.next;){var I=R.data,U=b>I.length?I.length:b;if(I.copy(v,v.length-b,0,U),b-=U,b===0){U===I.length?(++S,this.head=R.next?R.next:this.tail=null):(this.head=R,R.data=I.slice(U));break}++S}return this.length-=S,v}},{key:M,value:function(b,v){return O(this,h({},v,{depth:0,customInspect:!1}))}}]),y}()},{buffer:3,util:2}],23:[function(o,a){(function(l){(function(){function h(u,d){m(u,d),p(u)}function p(u){u._writableState&&!u._writableState.emitClose||u._readableState&&!u._readableState.emitClose||u.emit("close")}function m(u,d){u.emit("error",d)}a.exports={destroy:function(u,d){var w=this,g=this._readableState&&this._readableState.destroyed,E=this._writableState&&this._writableState.destroyed;return g||E?(d?d(u):u&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,l.nextTick(m,this,u)):l.nextTick(m,this,u)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(u||null,function(x){!d&&x?w._writableState?w._writableState.errorEmitted?l.nextTick(p,w):(w._writableState.errorEmitted=!0,l.nextTick(h,w,x)):l.nextTick(h,w,x):d?(l.nextTick(p,w),d(x)):l.nextTick(p,w)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(u,d){var w=u._readableState,g=u._writableState;w&&w.autoDestroy||g&&g.autoDestroy?u.destroy(d):u.emit("error",d)}}}).call(this)}).call(this,o("_process"))},{_process:12}],24:[function(o,a){function l(d){var w=!1;return function(){if(!w){w=!0;for(var g=arguments.length,E=Array(g),x=0;x<g;x++)E[x]=arguments[x];d.apply(this,E)}}}function h(){}function p(d){return d.setHeader&&typeof d.abort=="function"}function m(d,w,g){if(typeof w=="function")return m(d,null,w);w||(w={}),g=l(g||h);var E=w.readable||w.readable!==!1&&d.readable,x=w.writable||w.writable!==!1&&d.writable,O=function(){d.writable||y()},M=d._writableState&&d._writableState.finished,y=function(){x=!1,M=!0,E||g.call(d)},b=d._readableState&&d._readableState.endEmitted,v=function(){E=!1,b=!0,x||g.call(d)},R=function(U){g.call(d,U)},S=function(){var U;return E&&!b?(d._readableState&&d._readableState.ended||(U=new u),g.call(d,U)):x&&!M?(d._writableState&&d._writableState.ended||(U=new u),g.call(d,U)):void 0},I=function(){d.req.on("finish",y)};return p(d)?(d.on("complete",y),d.on("abort",S),d.req?I():d.on("request",I)):x&&!d._writableState&&(d.on("end",O),d.on("close",O)),d.on("end",v),d.on("finish",y),w.error!==!1&&d.on("error",R),d.on("close",S),function(){d.removeListener("complete",y),d.removeListener("abort",S),d.removeListener("request",I),d.req&&d.req.removeListener("finish",y),d.removeListener("end",O),d.removeListener("close",O),d.removeListener("finish",y),d.removeListener("end",v),d.removeListener("error",R),d.removeListener("close",S)}}var u=o("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;a.exports=m},{"../../../errors":15}],25:[function(o,a){a.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(o,a){function l(M){var y=!1;return function(){y||(y=!0,M.apply(void 0,arguments))}}function h(M){if(M)throw M}function p(M){return M.setHeader&&typeof M.abort=="function"}function m(M,y,b,v){v=l(v);var R=!1;M.on("close",function(){R=!0}),g===void 0&&(g=o("./end-of-stream")),g(M,{readable:y,writable:b},function(I){return I?v(I):(R=!0,void v())});var S=!1;return function(I){if(!R)return S?void 0:(S=!0,p(M)?M.abort():typeof M.destroy=="function"?M.destroy():void v(I||new O("pipe")))}}function u(M){M()}function d(M,y){return M.pipe(y)}function w(M){return M.length&&typeof M[M.length-1]=="function"?M.pop():h}var g,E=o("../../../errors").codes,x=E.ERR_MISSING_ARGS,O=E.ERR_STREAM_DESTROYED;a.exports=function(){for(var M=arguments.length,y=Array(M),b=0;b<M;b++)y[b]=arguments[b];var v=w(y);if(Array.isArray(y[0])&&(y=y[0]),2>y.length)throw new x("streams");var R,S=y.map(function(I,U){var k=U<y.length-1;return m(I,k,0<U,function(T){R||(R=T),T&&S.forEach(u),k||(S.forEach(u),v(R))})});return y.reduce(d)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(o,a){function l(p,m,u){return p.highWaterMark==null?m?p[u]:null:p.highWaterMark}var h=o("../../../errors").codes.ERR_INVALID_OPT_VALUE;a.exports={getHighWaterMark:function(p,m,u,d){var w=l(m,d,u);if(w!=null){if(!(isFinite(w)&&n(w)===w)||0>w){var g=d?u:"highWaterMark";throw new h(g,w)}return n(w)}return p.objectMode?16:16384}}},{"../../../errors":15}],28:[function(o,a){a.exports=o("events").EventEmitter},{events:7}],29:[function(o,a,l){l=a.exports=o("./lib/_stream_readable.js"),l.Stream=l,l.Readable=l,l.Writable=o("./lib/_stream_writable.js"),l.Duplex=o("./lib/_stream_duplex.js"),l.Transform=o("./lib/_stream_transform.js"),l.PassThrough=o("./lib/_stream_passthrough.js"),l.finished=o("./lib/internal/streams/end-of-stream.js"),l.pipeline=o("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(o,a,l){function h(d,w){for(var g in d)w[g]=d[g]}function p(d,w,g){return u(d,w,g)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var m=o("buffer"),u=m.Buffer;u.from&&u.alloc&&u.allocUnsafe&&u.allocUnsafeSlow?a.exports=m:(h(m,l),l.Buffer=p),p.prototype=Object.create(u.prototype),h(u,p),p.from=function(d,w,g){if(typeof d=="number")throw new TypeError("Argument must not be a number");return u(d,w,g)},p.alloc=function(d,w,g){if(typeof d!="number")throw new TypeError("Argument must be a number");var E=u(d);return w===void 0?E.fill(0):typeof g=="string"?E.fill(w,g):E.fill(w),E},p.allocUnsafe=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return u(d)},p.allocUnsafeSlow=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return m.SlowBuffer(d)}},{buffer:3}],31:[function(o,a,l){function h(S){if(!S)return"utf8";for(var I;;)switch(S){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return S;default:if(I)return;S=(""+S).toLowerCase(),I=!0}}function p(S){var I=h(S);if(typeof I!="string"&&(v.isEncoding===R||!R(S)))throw new Error("Unknown encoding: "+S);return I||S}function m(S){this.encoding=p(S);var I;switch(this.encoding){case"utf16le":this.text=E,this.end=x,I=4;break;case"utf8":this.fillLast=g,I=4;break;case"base64":this.text=O,this.end=M,I=3;break;default:return this.write=y,void(this.end=b)}this.lastNeed=0,this.lastTotal=0,this.lastChar=v.allocUnsafe(I)}function u(S){return 127>=S?0:S>>5==6?2:S>>4==14?3:S>>3==30?4:S>>6==2?-1:-2}function d(S,I,U){var k=I.length-1;if(k<U)return 0;var T=u(I[k]);return 0<=T?(0<T&&(S.lastNeed=T-1),T):--k<U||T===-2?0:(T=u(I[k]),0<=T?(0<T&&(S.lastNeed=T-2),T):--k<U||T===-2?0:(T=u(I[k]),0<=T?(0<T&&(T===2?T=0:S.lastNeed=T-3),T):0))}function w(S,I){if((192&I[0])!=128)return S.lastNeed=0,"�";if(1<S.lastNeed&&1<I.length){if((192&I[1])!=128)return S.lastNeed=1,"�";if(2<S.lastNeed&&2<I.length&&(192&I[2])!=128)return S.lastNeed=2,"�"}}function g(S){var I=this.lastTotal-this.lastNeed,U=w(this,S);return U===void 0?this.lastNeed<=S.length?(S.copy(this.lastChar,I,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(S.copy(this.lastChar,I,0,S.length),void(this.lastNeed-=S.length)):U}function E(S,I){if((S.length-I)%2==0){var U=S.toString("utf16le",I);if(U){var k=U.charCodeAt(U.length-1);if(55296<=k&&56319>=k)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1],U.slice(0,-1)}return U}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=S[S.length-1],S.toString("utf16le",I,S.length-1)}function x(S){var I=S&&S.length?this.write(S):"";if(this.lastNeed){var U=this.lastTotal-this.lastNeed;return I+this.lastChar.toString("utf16le",0,U)}return I}function O(S,I){var U=(S.length-I)%3;return U==0?S.toString("base64",I):(this.lastNeed=3-U,this.lastTotal=3,U==1?this.lastChar[0]=S[S.length-1]:(this.lastChar[0]=S[S.length-2],this.lastChar[1]=S[S.length-1]),S.toString("base64",I,S.length-U))}function M(S){var I=S&&S.length?this.write(S):"";return this.lastNeed?I+this.lastChar.toString("base64",0,3-this.lastNeed):I}function y(S){return S.toString(this.encoding)}function b(S){return S&&S.length?this.write(S):""}var v=o("safe-buffer").Buffer,R=v.isEncoding||function(S){switch(S=""+S,S&&S.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};l.StringDecoder=m,m.prototype.write=function(S){if(S.length===0)return"";var I,U;if(this.lastNeed){if(I=this.fillLast(S),I===void 0)return"";U=this.lastNeed,this.lastNeed=0}else U=0;return U<S.length?I?I+this.text(S,U):this.text(S,U):I||""},m.prototype.end=function(S){var I=S&&S.length?this.write(S):"";return this.lastNeed?I+"�":I},m.prototype.text=function(S,I){var U=d(this,S,I);if(!this.lastNeed)return S.toString("utf8",I);this.lastTotal=U;var k=S.length-(U-this.lastNeed);return S.copy(this.lastChar,0,k),S.toString("utf8",I,k)},m.prototype.fillLast=function(S){return this.lastNeed<=S.length?(S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(S.copy(this.lastChar,this.lastTotal-this.lastNeed,0,S.length),void(this.lastNeed-=S.length))}},{"safe-buffer":30}],32:[function(o,a){(function(l){(function(){function h(p){try{if(!l.localStorage)return!1}catch{return!1}var m=l.localStorage[p];return m!=null&&(m+"").toLowerCase()==="true"}a.exports=function(p,m){function u(){if(!d){if(h("throwDeprecation"))throw new Error(m);h("traceDeprecation")?console.trace(m):console.warn(m),d=!0}return p.apply(this,arguments)}if(h("noDeprecation"))return p;var d=!1;return u}}).call(this)}).call(this,typeof Nt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:Nt)},{}],"/":[function(o,a){function l(M){return M.replace(/a=ice-options:trickle\s\n/g,"")}function h(M){console.warn(M)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const p=o("debug")("simple-peer"),m=o("get-browser-rtc"),u=o("randombytes"),d=o("readable-stream"),w=o("queue-microtask"),g=o("err-code"),{Buffer:E}=o("buffer"),x=65536;class O extends d.Duplex{constructor(y){if(y=Object.assign({allowHalfOpen:!1},y),super(y),this._id=u(4).toString("hex").slice(0,7),this._debug("new peer %o",y),this.channelName=y.initiator?y.channelName||u(20).toString("hex"):null,this.initiator=y.initiator||!1,this.channelConfig=y.channelConfig||O.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},O.config,y.config),this.offerOptions=y.offerOptions||{},this.answerOptions=y.answerOptions||{},this.sdpTransform=y.sdpTransform||(b=>b),this.streams=y.streams||(y.stream?[y.stream]:[]),this.trickle=y.trickle===void 0||y.trickle,this.allowHalfTrickle=y.allowHalfTrickle!==void 0&&y.allowHalfTrickle,this.iceCompleteTimeout=y.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=y.wrtc&&typeof y.wrtc=="object"?y.wrtc:m(),!this._wrtc)throw g(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(b){return void this.destroy(g(b,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=b=>{this._onIceCandidate(b)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(b=>{this.destroy(g(b,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=b=>{this._setupData(b)},this.streams&&this.streams.forEach(b=>{this.addStream(b)}),this._pc.ontrack=b=>{this._onTrack(b)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(y){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof y=="string")try{y=JSON.parse(y)}catch{y={}}this._debug("signal()"),y.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),y.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(y.transceiverRequest.kind,y.transceiverRequest.init)),y.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(y.candidate):this._pendingCandidates.push(y.candidate)),y.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(y)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(b=>{this._addIceCandidate(b)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(b=>{this.destroy(g(b,"ERR_SET_REMOTE_DESCRIPTION"))}),y.sdp||y.candidate||y.renegotiate||y.transceiverRequest||this.destroy(g(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(y){const b=new this._wrtc.RTCIceCandidate(y);this._pc.addIceCandidate(b).catch(v=>{!b.address||b.address.endsWith(".local")?h("Ignoring unsupported ICE candidate."):this.destroy(g(v,"ERR_ADD_ICE_CANDIDATE"))})}send(y){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(y)}}addTransceiver(y,b){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(y,b),this._needsNegotiation()}catch(v){this.destroy(g(v,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:y,init:b}})}}addStream(y){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),y.getTracks().forEach(b=>{this.addTrack(b,y)})}}addTrack(y,b){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const v=this._senderMap.get(y)||new Map;let R=v.get(b);if(!R)R=this._pc.addTrack(y,b),v.set(b,R),this._senderMap.set(y,v),this._needsNegotiation();else throw R.removed?g(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):g(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(y,b,v){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const R=this._senderMap.get(y),S=R?R.get(v):null;if(!S)throw g(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");b&&this._senderMap.set(b,R),S.replaceTrack==null?this.destroy(g(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):S.replaceTrack(b)}removeTrack(y,b){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const v=this._senderMap.get(y),R=v?v.get(b):null;if(!R)throw g(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{R.removed=!0,this._pc.removeTrack(R)}catch(S){S.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(R):this.destroy(g(S,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(y){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),y.getTracks().forEach(b=>{this.removeTrack(b,y)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,w(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(y){this._destroy(y,()=>{})}_destroy(y,b){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",y&&(y.message||y)),w(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",y&&(y.message||y)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,y&&this.emit("error",y),this.emit("close"),b()}))}_setupData(y){if(!y.channel)return this.destroy(g(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=y.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=x),this.channelName=this._channel.label,this._channel.onmessage=v=>{this._onChannelMessage(v)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=v=>{const R=v.error instanceof Error?v.error:new Error(`Datachannel error: ${v.message} ${v.filename}:${v.lineno}:${v.colno}`);this.destroy(g(R,"ERR_DATA_CHANNEL"))};let b=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(b&&this._onChannelClose(),b=!0):b=!1},5e3)}_read(){}_write(y,b,v){if(this.destroyed)return v(g(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(y)}catch(R){return this.destroy(g(R,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>x?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=v):v(null)}else this._debug("write before connect"),this._chunk=y,this._cb=v}_onFinish(){if(!this.destroyed){const y=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?y():this.once("connect",y)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(y=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(y.sdp=l(y.sdp)),y.sdp=this.sdpTransform(y.sdp);const b=()=>{if(!this.destroyed){const v=this._pc.localDescription||y;this._debug("signal"),this.emit("signal",{type:v.type,sdp:v.sdp})}};this._pc.setLocalDescription(y).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?b():this.once("_iceComplete",b))}).catch(v=>{this.destroy(g(v,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(y=>{this.destroy(g(y,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(y=>{y.mid||!y.sender.track||y.requested||(y.requested=!0,this.addTransceiver(y.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(y=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(y.sdp=l(y.sdp)),y.sdp=this.sdpTransform(y.sdp);const b=()=>{if(!this.destroyed){const v=this._pc.localDescription||y;this._debug("signal"),this.emit("signal",{type:v.type,sdp:v.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(y).then(()=>{this.destroyed||(this.trickle||this._iceComplete?b():this.once("_iceComplete",b))}).catch(v=>{this.destroy(g(v,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(y=>{this.destroy(g(y,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(g(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const y=this._pc.iceConnectionState,b=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",y,b),this.emit("iceStateChange",y,b),(y==="connected"||y==="completed")&&(this._pcReady=!0,this._maybeReady()),y==="failed"&&this.destroy(g(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),y==="closed"&&this.destroy(g(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(y){const b=v=>(Object.prototype.toString.call(v.values)==="[object Array]"&&v.values.forEach(R=>{Object.assign(v,R)}),v);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(v=>{const R=[];v.forEach(S=>{R.push(b(S))}),y(null,R)},v=>y(v)):0<this._pc.getStats.length?this._pc.getStats(v=>{if(this.destroyed)return;const R=[];v.result().forEach(S=>{const I={};S.names().forEach(U=>{I[U]=S.stat(U)}),I.id=S.id,I.type=S.type,I.timestamp=S.timestamp,R.push(b(I))}),y(null,R)},v=>y(v)):y(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const y=()=>{this.destroyed||this.getStats((b,v)=>{if(this.destroyed)return;b&&(v=[]);const R={},S={},I={};let U=!1;v.forEach(T=>{(T.type==="remotecandidate"||T.type==="remote-candidate")&&(R[T.id]=T),(T.type==="localcandidate"||T.type==="local-candidate")&&(S[T.id]=T),(T.type==="candidatepair"||T.type==="candidate-pair")&&(I[T.id]=T)});const k=T=>{U=!0;let F=S[T.localCandidateId];F&&(F.ip||F.address)?(this.localAddress=F.ip||F.address,this.localPort=+F.port):F&&F.ipAddress?(this.localAddress=F.ipAddress,this.localPort=+F.portNumber):typeof T.googLocalAddress=="string"&&(F=T.googLocalAddress.split(":"),this.localAddress=F[0],this.localPort=+F[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let B=R[T.remoteCandidateId];B&&(B.ip||B.address)?(this.remoteAddress=B.ip||B.address,this.remotePort=+B.port):B&&B.ipAddress?(this.remoteAddress=B.ipAddress,this.remotePort=+B.portNumber):typeof T.googRemoteAddress=="string"&&(B=T.googRemoteAddress.split(":"),this.remoteAddress=B[0],this.remotePort=+B[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(v.forEach(T=>{T.type==="transport"&&T.selectedCandidatePairId&&k(I[T.selectedCandidatePairId]),(T.type==="googCandidatePair"&&T.googActiveConnection==="true"||(T.type==="candidatepair"||T.type==="candidate-pair")&&T.selected)&&k(T)}),!U&&(!Object.keys(I).length||Object.keys(S).length))return void setTimeout(y,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(F){return this.destroy(g(F,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const T=this._cb;this._cb=null,T(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};y()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>x)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(y=>{this._pc.removeTrack(y),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(y){this.destroyed||(y.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:y.candidate.candidate,sdpMLineIndex:y.candidate.sdpMLineIndex,sdpMid:y.candidate.sdpMid}}):!y.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),y.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(y){if(this.destroyed)return;let b=y.data;b instanceof ArrayBuffer&&(b=E.from(b)),this.push(b)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const y=this._cb;this._cb=null,y(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(y){this.destroyed||y.streams.forEach(b=>{this._debug("on track"),this.emit("track",y.track,b),this._remoteTracks.push({track:y.track,stream:b}),this._remoteStreams.some(v=>v.id===b.id)||(this._remoteStreams.push(b),w(()=>{this._debug("on stream"),this.emit("stream",b)}))})}_debug(){const y=[].slice.call(arguments);y[0]="["+this._id+"] "+y[0],p.apply(null,y)}}O.WEBRTC_SUPPORT=!!m(),O.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},O.channelConfig={},a.exports=O},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(ro);var Fl=ro.exports;const Pl=Ul(Fl),Qr=0,ti=1,io=2,so=(e,t)=>{W(e,Qr);const n=sa(t);it(e,n)},oo=(e,t,n)=>{W(e,ti),it(e,ea(t,n))},Bl=(e,t,n)=>oo(t,n,lt(e)),co=(e,t,n)=>{try{Zc(t,lt(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},jl=(e,t)=>{W(e,io),it(e,t)},Vl=co,Wl=(e,t,n,r)=>{const s=H(e);switch(s){case Qr:Bl(e,t,n);break;case ti:co(e,n,r);break;case io:Vl(e,n,r);break;default:throw new Error("Unknown message type")}return s},cr=3e4;class ql extends Wi{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const n=Yt();this.getLocalState()!==null&&cr/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const r=[];this.meta.forEach((s,o)=>{o!==this.clientID&&cr<=n-s.lastUpdated&&this.states.has(o)&&r.push(o)}),r.length>0&&Rr(this,r,"timeout")},Ut(cr/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const n=this.clientID,r=this.meta.get(n),s=r===void 0?0:r.clock+1,o=this.states.get(n);t===null?this.states.delete(n):this.states.set(n,t),this.meta.set(n,{clock:s,lastUpdated:Yt()});const a=[],l=[],h=[],p=[];t===null?p.push(n):o==null?t!=null&&a.push(n):(l.push(n),Ve(o,t)||h.push(n)),(a.length>0||h.length>0||p.length>0)&&this.emit("change",[{added:a,updated:h,removed:p},"local"]),this.emit("update",[{added:a,updated:l,removed:p},"local"])}setLocalStateField(t,n){const r=this.getLocalState();r!==null&&this.setLocalState({...r,[t]:n})}getStates(){return this.states}}const Rr=(e,t,n)=>{const r=[];for(let s=0;s<t.length;s++){const o=t[s];if(e.states.has(o)){if(e.states.delete(o),o===e.clientID){const a=e.meta.get(o);e.meta.set(o,{clock:a.clock+1,lastUpdated:Yt()})}r.push(o)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},Nn=(e,t,n=e.states)=>{const r=t.length,s=ht();W(s,r);for(let o=0;o<r;o++){const a=t[o],l=n.get(a)||null,h=e.meta.get(a).clock;W(s,a),W(s,h),xt(s,JSON.stringify(l))}return nt(s)},zl=(e,t,n)=>{const r=Vt(t),s=Yt(),o=[],a=[],l=[],h=[],p=H(r);for(let m=0;m<p;m++){const u=H(r);let d=H(r);const w=JSON.parse(zt(r)),g=e.meta.get(u),E=e.states.get(u),x=g===void 0?0:g.clock;(x<d||x===d&&w===null&&e.states.has(u))&&(w===null?u===e.clientID&&e.getLocalState()!=null?d++:e.states.delete(u):e.states.set(u,w),e.meta.set(u,{clock:d,lastUpdated:s}),g===void 0&&w!==null?o.push(u):g!==void 0&&w===null?h.push(u):w!==null&&(Ve(w,E)||l.push(u),a.push(u)))}(o.length>0||l.length>0||h.length>0)&&e.emit("change",[{added:o,updated:l,removed:h},n]),(o.length>0||a.length>0||h.length>0)&&e.emit("update",[{added:o,updated:a,removed:h},n])},Hl=(e,t)=>{const n=fr(e).buffer,r=fr(t).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then(s=>crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},ao=(e,t)=>{if(!t)return Nr(e);const n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e).then(r=>{const s=ht();return xt(s,"AES-GCM"),it(s,n),it(s,new Uint8Array(r)),nt(s)})},Yl=(e,t)=>{const n=ht();return Te(n,e),ao(nt(n),t)},lo=(e,t)=>{if(!t)return Nr(e);const n=Vt(e);zt(n)!=="AES-GCM"&&cc(Ft("Unknown encryption algorithm"));const s=lt(n),o=lt(n);return crypto.subtle.decrypt({name:"AES-GCM",iv:s},t,o).then(a=>new Uint8Array(a))},Jl=(e,t)=>lo(e,t).then(n=>De(Vt(new Uint8Array(n)))),yt=jc("y-webrtc"),Ae=0,ho=3,Ze=1,ei=4,xn=new Map,he=new Map,uo=e=>{let t=!0;e.webrtcConns.forEach(n=>{n.synced||(t=!1)}),(!t&&e.synced||t&&!e.synced)&&(e.synced=t,e.provider.emit("synced",[{synced:t}]),yt("synced ",St,e.name,fe," with all peers"))},fo=(e,t,n)=>{const r=Vt(t),s=ht(),o=H(r);if(e===void 0)return null;const a=e.awareness,l=e.doc;let h=!1;switch(o){case Ae:{W(s,Ae);const p=Wl(r,s,l,e);p===ti&&!e.synced&&n(),p===Qr&&(h=!0);break}case ho:W(s,Ze),it(s,Nn(a,Array.from(a.getStates().keys()))),h=!0;break;case Ze:zl(a,lt(r),e);break;case ei:{const p=ue(r)===1,m=zt(r);if(m!==e.peerId&&(e.bcConns.has(m)&&!p||!e.bcConns.has(m)&&p)){const u=[],d=[];p?(e.bcConns.add(m),d.push(m)):(e.bcConns.delete(m),u.push(m)),e.provider.emit("peers",[{added:d,removed:u,webrtcPeers:Array.from(e.webrtcConns.keys()),bcPeers:Array.from(e.bcConns)}]),po(e)}break}default:return console.error("Unable to compute message"),s}return h?s:null},Gl=(e,t)=>{const n=e.room;return yt("received message from ",St,e.remotePeerId,Ur," (",n.name,")",fe,Bn),fo(n,t,()=>{e.synced=!0,yt("synced ",St,n.name,fe," with ",St,e.remotePeerId),uo(n)})},ar=(e,t)=>{yt("send message to ",St,e.remotePeerId,fe,Ur," (",e.room.name,")",Bn);try{e.peer.send(nt(t))}catch{}},$l=(e,t)=>{yt("broadcast message in ",St,e.name,fe),e.webrtcConns.forEach(n=>{try{n.peer.send(t)}catch{}})};class Mi{constructor(t,n,r,s){yt("establishing connection to ",St,r),this.room=s,this.remotePeerId=r,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Pl({initiator:n,...s.provider.peerOpts}),this.peer.on("signal",o=>{this.glareToken===void 0&&(this.glareToken=Date.now()+Math.random()),ni(t,s,{to:r,from:s.peerId,type:"signal",token:this.glareToken,signal:o})}),this.peer.on("connect",()=>{yt("connected to ",St,r),this.connected=!0;const a=s.provider.doc,l=s.awareness,h=ht();W(h,Ae),so(h,a),ar(this,h);const p=l.getStates();if(p.size>0){const m=ht();W(m,Ze),it(m,Nn(l,Array.from(p.keys()))),ar(this,m)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,s.webrtcConns.has(this.remotePeerId)&&(s.webrtcConns.delete(this.remotePeerId),s.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(s.webrtcConns.keys()),bcPeers:Array.from(s.bcConns)}])),uo(s),this.peer.destroy(),yt("closed connection to ",St,r),Ar(s)}),this.peer.on("error",o=>{yt("Error in connection to ",St,r,": ",o),Ar(s)}),this.peer.on("data",o=>{const a=Gl(this,o);a!==null&&ar(this,a)})}destroy(){this.peer.destroy()}}const te=(e,t)=>ao(t,e.key).then(n=>e.mux(()=>xl(e.name,n))),Ui=(e,t)=>{e.bcconnected&&te(e,t),$l(e,t)},Ar=e=>{xn.forEach(t=>{t.connected&&(t.send({type:"subscribe",topics:[e.name]}),e.webrtcConns.size<e.provider.maxConns&&ni(t,e,{type:"announce",from:e.peerId}))})},po=e=>{if(e.provider.filterBcConns){const t=ht();W(t,ei),He(t,1),xt(t,e.peerId),te(e,nt(t))}};class Kl{constructor(t,n,r,s){this.peerId=Gi(),this.doc=t,this.awareness=n.awareness,this.provider=n,this.synced=!1,this.name=r,this.key=s,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=Ml(),this.bcconnected=!1,this._bcSubscriber=o=>lo(new Uint8Array(o),s).then(a=>this.mux(()=>{const l=fo(this,a,()=>{});l&&te(this,nt(l))})),this._docUpdateHandler=(o,a)=>{const l=ht();W(l,Ae),jl(l,o),Ui(this,nt(l))},this._awarenessUpdateHandler=({added:o,updated:a,removed:l},h)=>{const p=o.concat(a).concat(l),m=ht();W(m,Ze),it(m,Nn(this.awareness,p)),Ui(this,nt(m))},this._beforeUnloadHandler=()=>{Rr(this.awareness,[t.clientID],"window unload"),he.forEach(o=>{o.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),Ar(this);const t=this.name;Ll(t,this._bcSubscriber),this.bcconnected=!0,po(this);const n=ht();W(n,Ae),so(n,this.doc),te(this,nt(n));const r=ht();W(r,Ae),oo(r,this.doc),te(this,nt(r));const s=ht();W(s,ho),te(this,nt(s));const o=ht();W(o,Ze),it(o,Nn(this.awareness,[this.doc.clientID])),te(this,nt(o))}disconnect(){xn.forEach(n=>{n.connected&&n.send({type:"unsubscribe",topics:[this.name]})}),Rr(this.awareness,[this.doc.clientID],"disconnect");const t=ht();W(t,ei),He(t,0),xt(t,this.peerId),te(this,nt(t)),Nl(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(n=>n.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const Xl=(e,t,n,r)=>{if(he.has(n))throw Ft(`A Yjs Doc connected to room "${n}" already exists!`);const s=new Kl(e,t,n,r);return he.set(n,s),s},ni=(e,t,n)=>{t.key?Yl(n,t.key).then(r=>{e.send({type:"publish",topic:t.name,data:es(r)})}):e.send({type:"publish",topic:t.name,data:n})};class Zl extends Dl{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{yt(`connected (${t})`);const n=Array.from(he.keys());this.send({type:"subscribe",topics:n}),he.forEach(r=>ni(this,r,{type:"announce",from:r.peerId}))}),this.on("message",n=>{switch(n.type){case"publish":{const r=n.topic,s=he.get(r);if(s==null||typeof r!="string")return;const o=a=>{const l=s.webrtcConns,h=s.peerId;if(a==null||a.from===h||a.to!==void 0&&a.to!==h||s.bcConns.has(a.from))return;const p=l.has(a.from)?()=>{}:()=>s.provider.emit("peers",[{removed:[],added:[a.from],webrtcPeers:Array.from(s.webrtcConns.keys()),bcPeers:Array.from(s.bcConns)}]);switch(a.type){case"announce":l.size<s.provider.maxConns&&(mt(l,a.from,()=>new Mi(this,!0,a.from,s)),p());break;case"signal":if(a.signal.type==="offer"){const m=l.get(a.from);if(m){const u=a.token,d=m.glareToken;if(d&&d>u){yt("offer rejected: ",a.from);return}m.glareToken=void 0}}if(a.signal.type==="answer"){yt("offer answered by: ",a.from);const m=l.get(a.from);m.glareToken=void 0}a.to===h&&(mt(l,a.from,()=>new Mi(this,!1,a.from,s)).peer.signal(a.signal),p());break}};s.key?typeof n.data=="string"&&Jl(ns(n.data),s.key).then(o):o(n.data)}}}),this.on("disconnect",()=>yt(`disconnect (${t})`))}}const lr=e=>{e.emit("status",[{connected:e.connected}])};class Ql extends Vi{constructor(t,n,{signaling:r=["wss://y-webrtc-eu.fly.dev"],password:s=null,awareness:o=new ql(n),maxConns:a=20+Ut(sc()*15),filterBcConns:l=!0,peerOpts:h={}}={}){super(),this.roomName=t,this.doc=n,this.filterBcConns=l,this.awareness=o,this.shouldConnect=!1,this.signalingUrls=r,this.signalingConns=[],this.maxConns=a,this.peerOpts=h,this.key=s?Hl(s,t):Nr(null),this.room=null,this.key.then(p=>{this.room=Xl(n,this,t,p),this.shouldConnect?this.room.connect():this.room.disconnect(),lr(this)}),this.connect(),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{const n=mt(xn,t,()=>new Zl(t));this.signalingConns.push(n),n.providers.add(this)}),this.room&&(this.room.connect(),lr(this))}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),xn.delete(t.url))}),this.room&&(this.room.disconnect(),lr(this))}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),he.delete(this.roomName)}),super.destroy()}}function th(){const{providers:e}=Hs(),t=s=>{if(!e.has(s)){const o=new Map;return e.set(s,o),o}return e.get(s)};return{ensureProvider:t,setProvider:(s,o,a)=>{var l;(l=t(s).get(o))==null||l.destroy(),t(s).set(o,a)},removeProvider:(s,o)=>{var a;(a=t(s).get(o))==null||a.destroy(),t(s).delete(o)}}}function oh(e,t){const n=zn(),{setProvider:r,removeProvider:s}=th(),o=Dt(()=>Bi(e)),a=We();return Mn(o,(l,h)=>{if(l){const p=new Ql(l,n.value,t);a.value=p,r(Ai(mr.Webrtc),l,p)}!l&&h&&s(Ai(mr.Webrtc),h)},{immediate:!0}),Dt(()=>a.value)}export{sh as _,nh as a,ih as b,rh as c,oh as u};
